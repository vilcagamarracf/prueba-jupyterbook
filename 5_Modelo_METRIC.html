
<!DOCTYPE html>


<html lang="es" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5. Balance de Energía Superficial - Modelo METRIC &#8212; Prueba de tesis con jupyterbook</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=78d55cf8"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="_static/translations.js?v=efdbd0b9"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = '5_Modelo_METRIC';</script>
    <link rel="icon" href="_static/favicon.png"/>
    <link rel="index" title="Índice" href="genindex.html" />
    <link rel="search" title="Búsqueda" href="search.html" />
    <link rel="prev" title="4. Selección de pixeles" href="4_Seleccion_pixeles.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Saltar al contenido principal</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="README.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/favicon.png" class="logo__image only-light" alt="Prueba de tesis con jupyterbook - Home"/>
    <script>document.write(`<img src="_static/favicon.png" class="logo__image only-dark" alt="Prueba de tesis con jupyterbook - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="README.html">
                    Aplicación del Modelo METRIC en cultivos de arroz
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Desarrollo</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="1_Explorar_imagenes_local.html">1. Visualizando imágenes</a></li>
<li class="toctree-l1"><a class="reference internal" href="2_Exploracion_datos_estacion.html">2. Visualización de datos de estación meteorológica</a></li>
<li class="toctree-l1"><a class="reference internal" href="3_H_Desarrollo.html">3. Sección iterativa y parámetro H</a></li>
<li class="toctree-l1"><a class="reference internal" href="4_Seleccion_pixeles.html">4. Selección de pixeles</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">5. Balance de Energía Superficial - Modelo METRIC</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/vilcagamarracf/Inv_arroz_METRIC" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Repositorio de origen"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/5_Modelo_METRIC.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Balance de Energía Superficial - Modelo METRIC</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inicio">5.1. Inicio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento">5.2. Procesamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas">5.2.1. Tablas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revisar-imagenes">5.2.2. Revisar imagenes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lai">5.2.2.1. LAI</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-con-cartoee">5.2.3. Gráficas con cartoee</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-ndvi-iaf-albedo-ts">5.2.3.1. Gráfica NDVI-IAF-Albedo-Ts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-componentes-balance-radiacion">5.2.3.2. Gráfica Componentes Balance Radiación</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-1x1">5.2.3.3. Gráficas 1x1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-et">5.2.3.4. Gráfica ET</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-et-1x7-muy-largo-y-no-se-ubica-bien-la-rampa-de-color">5.2.3.4.1. Gráfica ET 1x7 (Muy largo y no se ubica bien la rampa de color)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5.2.3.4.2. Gráficas 1x1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-boxplot">5.2.4. Gráfica Boxplot</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <hr class="docutils" />
<p> Libreta n° 5 sobre el trabajo de investigación: </p>
<center>
<p> 
<b>
"Estimación de la evapotranspiración espacio-temporal en arrozales usando imágenes satelitales, Departamento de Lambayeque" 
</b>
</p>
</center>
<p>Autor: Cesar Francisco Vilca Gamarra</p>
<p>Repositorio alojado en <a class="reference external" href="https://github.com/vilcagamarracf/Inv_arroz_METRIC">GitHub</a></p>
<p>Marzo, 2022</p>
<hr class="docutils" />
<section id="balance-de-energia-superficial-modelo-metric">
<h1><span class="section-number">5. </span>Balance de Energía Superficial - Modelo METRIC<a class="headerlink" href="#balance-de-energia-superficial-modelo-metric" title="Link to this heading">#</a></h1>
<p><strong>Satellite-Based Energy Balance for Mapping Evapotranspiration With Internalized Calibration (METRIC)</strong></p>
<p>Descripción:</p>
<ul class="simple">
<li><p>METRIC es un modelo de procesamiento de imágenes para calcular la ET como residuo del balance energético de la superficie.</p></li>
<li><p>METRIC fue desarrollado por la Universidad de Idaho para su aplicación a imágenes de satélite Landsat con el fin de maximizar la resolución del producto ET (30 m).</p></li>
<li><p>METRIC utiliza como base el proceso pionero de balance energético SEBAL desarrollado en los Países Bajos por Bastiaanssen et al..</p></li>
</ul>
<p>Aplicación de referencia:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/et-brasil/geeSEBAL/blob/a8242225bcb184329372ee0dbdc411d1e9d5c766/JavaScrpit/tools.js">geeSEBAL en GitHub</a></p></li>
</ul>
<section id="inicio">
<h2><span class="section-number">5.1. </span>Inicio<a class="headerlink" href="#inicio" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">ee</span>          <span class="c1"># Earth Engine Python API</span>
<span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>

<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">math</span>
<span class="kn">from</span> <span class="nn">pprint</span> <span class="kn">import</span> <span class="n">pprint</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span> <span class="c1"># Visualizar máximo de 30 columnas</span>

<span class="kn">import</span> <span class="nn">geemap</span>
<span class="kn">import</span> <span class="nn">geemap.colormaps</span> <span class="k">as</span> <span class="nn">cmp</span>    <span class="c1"># Paletas para visualización de imágenes</span>

<span class="kn">from</span> <span class="nn">funciones</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">ModuleNotFoundError</span><span class="g g-Whitespace">                       </span>Traceback (most recent call last)
<span class="n">Cell</span> <span class="n">In</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">line</span> <span class="mi">1</span>
<span class="ne">----&gt; </span><span class="mi">1</span> <span class="kn">import</span> <span class="nn">ee</span>          <span class="c1"># Earth Engine Python API</span>
<span class="g g-Whitespace">      </span><span class="mi">2</span> <span class="n">ee</span><span class="o">.</span><span class="n">Initialize</span><span class="p">()</span>
<span class="g g-Whitespace">      </span><span class="mi">4</span> <span class="kn">import</span> <span class="nn">os</span>

<span class="ne">ModuleNotFoundError</span>: No module named &#39;ee&#39;
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------------------------------------------------------------------------</span>
<span class="c1"># Pruebas: En caso de realizar alguna edición al archivo &#39;funciones.py&#39; realizar lo siguiente:</span>
<span class="c1"># ------------------------------------------------------------------------------------------------</span>

<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">importlib</span><span class="o">.</span><span class="n">reload</span><span class="p">(</span><span class="n">sys</span><span class="o">.</span><span class="n">modules</span><span class="p">[</span><span class="s1">&#39;funciones&#39;</span><span class="p">])</span> <span class="c1"># Importa las funciones del archivo con las modificaciones aplicadas</span>
<span class="kn">from</span> <span class="nn">funciones</span> <span class="kn">import</span> <span class="o">*</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># ------------------------------------------------</span>
<span class="c1"># Importando áreas de estudio</span>
<span class="c1"># ------------------------------------------------</span>

<span class="c1"># Importar asset público: Distrito de Ferreñafe</span>
<span class="n">asset_dist</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">FeatureCollection</span><span class="p">(</span><span class="s1">&#39;users/CesarVilca/distritos&#39;</span><span class="p">)</span>
<span class="n">dist_fcol</span> <span class="o">=</span> <span class="n">asset_dist</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;DISTRITO&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;FERREÑAFE&#39;</span><span class="p">)</span>
<span class="n">roi</span> <span class="o">=</span> <span class="n">dist_fcol</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>   <span class="c1"># ee.Geometry tipo caja</span>

<span class="c1"># Importar shapefile de Áreas voladas (archivo en local)</span>
<span class="n">ruta_ferrenafe</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;input/Ferreñafe_areas_2.shp&#39;</span>

<span class="c1"># Lectura como FeatureCollection con geemap</span>
<span class="n">predios_agricolas</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">shp_to_ee</span><span class="p">(</span><span class="n">ruta_ferrenafe</span><span class="p">)</span>
<span class="n">predios_vis</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">()</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># Ver solo bordes, no relleno</span>

<span class="n">predios_bound</span> <span class="o">=</span> <span class="n">predios_agricolas</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">bounds</span><span class="p">()</span>
<span class="n">predios_bound_vis</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">()</span><span class="o">.</span><span class="n">paint</span><span class="p">(</span><span class="n">predios_bound</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  <span class="c1"># Ver solo bordes, no relleno</span>

<span class="c1"># ------------------------------------------------</span>
<span class="c1"># Parámetros de visualización de mapas con geemap</span>
<span class="c1"># ------------------------------------------------</span>

<span class="c1"># Para imágenes Landsat 8 y 9 TOA</span>
<span class="n">vis_rgb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.3</span><span class="p">,</span> <span class="s1">&#39;bands&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;B4&#39;</span><span class="p">,</span> <span class="s1">&#39;B3&#39;</span><span class="p">,</span> <span class="s1">&#39;B2&#39;</span><span class="p">]}</span>

<span class="c1"># Paletas de colores</span>
<span class="n">albedo_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;68181f&#39;</span><span class="p">,</span> <span class="s1">&#39;d6604d&#39;</span><span class="p">,</span> <span class="s1">&#39;f9dbc7&#39;</span><span class="p">,</span> <span class="s1">&#39;d1e5f0&#39;</span><span class="p">,</span> <span class="s1">&#39;2166ac&#39;</span><span class="p">,</span> <span class="s1">&#39;053061&#39;</span><span class="p">]</span>  <span class="c1"># 0 - 0.5</span>
<span class="n">ndvi_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ffffff&#39;</span><span class="p">,</span> <span class="s1">&#39;ce7e45&#39;</span><span class="p">,</span> <span class="s1">&#39;fad163&#39;</span><span class="p">,</span> <span class="s1">&#39;74a909&#39;</span><span class="p">,</span> <span class="s1">&#39;3a7405&#39;</span><span class="p">,</span> <span class="s1">&#39;1a3b03&#39;</span><span class="p">]</span>  <span class="c1"># -0.2 - 1  &#39;0048fb&#39;,</span>
<span class="n">ts_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;fefccc&#39;</span><span class="p">,</span> <span class="s1">&#39;fbd976&#39;</span><span class="p">,</span> <span class="s1">&#39;f08c39&#39;</span><span class="p">,</span> <span class="s1">&#39;ea4a33&#39;</span><span class="p">,</span> <span class="s1">&#39;e43d32&#39;</span><span class="p">,</span> <span class="s1">&#39;812026&#39;</span><span class="p">]</span>  <span class="c1"># 280 - 330 en K o 6.85 - 56.85 en °C</span>
<span class="n">rn_cmp</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;560e0d&#39;</span><span class="p">,</span> <span class="s1">&#39;fd5903&#39;</span><span class="p">,</span> <span class="s1">&#39;fbfe04&#39;</span><span class="p">,</span> <span class="s1">&#39;3aff01&#39;</span><span class="p">,</span> <span class="s1">&#39;01feef&#39;</span><span class="p">,</span> <span class="s1">&#39;0000fe&#39;</span><span class="p">,</span> <span class="s1">&#39;fd6dfd&#39;</span><span class="p">,</span> <span class="s1">&#39;ffffff&#39;</span><span class="p">]</span>
<span class="n">rn_cmp_r</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ffffff&#39;</span><span class="p">,</span> <span class="s1">&#39;fd6dfd&#39;</span><span class="p">,</span> <span class="s1">&#39;0000fe&#39;</span><span class="p">,</span> <span class="s1">&#39;01feef&#39;</span><span class="p">,</span> <span class="s1">&#39;3aff01&#39;</span><span class="p">,</span> <span class="s1">&#39;fbfe04&#39;</span><span class="p">,</span> <span class="s1">&#39;fd5903&#39;</span><span class="p">,</span> <span class="s1">&#39;560e0d&#39;</span><span class="p">]</span>

<span class="c1"># Parámetros de visualización de gráficas con matplotlib</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;font.family&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;serif&#39;</span>  <span class="c1">#&#39;serif&#39;, &#39;Arial&#39;  # default es &#39;sans-serif&#39;</span>
<span class="c1"># plt.rcParams[&#39;font.family&#39;] = &#39;Times New Roman&#39;</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.titlesize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;axes.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">12</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;figure.dpi&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">72</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="procesamiento">
<h2><span class="section-number">5.2. </span>Procesamiento<a class="headerlink" href="#procesamiento" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># 6 Imágenes Landsat seleccionadas</span>
<span class="n">lista_ids</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;LANDSAT/LC09/C02/T1/LC09_010065_20220113&#39;</span><span class="p">,</span>  <span class="c1"># 0 - 01/13 - l9 OJO: NDVI negativos -&gt; Posible riego 01 13</span>
    <span class="s1">&#39;LANDSAT/LC09/C02/T1/LC09_010065_20220129&#39;</span><span class="p">,</span>  <span class="c1"># 1 - 01/29 - l9 producia error en iteracion hasta bajar el ET</span>
    <span class="s1">&#39;LANDSAT/LC08/C02/T1/LC08_010065_20220310&#39;</span><span class="p">,</span>  <span class="c1"># 2 - 03/10 - l8 mayoria de superficie cubierta por arroz</span>
    <span class="c1"># &#39;LANDSAT/LC09/C02/T1/LC09_010065_20220403&#39;,  # 3 - 04/03 - l9 &lt;------</span>
    <span class="s1">&#39;LANDSAT/LC09/C02/T1/LC09_010065_20220505&#39;</span><span class="p">,</span>  <span class="c1"># 4 - 05/05 - l9 &lt;------</span>
    <span class="s1">&#39;LANDSAT/LC09/C02/T1/LC09_010065_20220521&#39;</span><span class="p">,</span>  <span class="c1"># 5 - 05/21 - l9 &lt;------</span>
    <span class="s1">&#39;LANDSAT/LC08/C02/T1/LC08_010065_20220614&#39;</span>   <span class="c1"># 6 - 06/14 - l8</span>
<span class="p">]</span>

<span class="c1"># DEM SRTM </span>
<span class="c1"># Ojo: El mapa Aspect no se puede obtener en los límites -&gt; usar áreas mayores al área de estudio</span>
<span class="n">dem</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="s2">&quot;USGS/SRTMGL1_003&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =============================================================</span>
<span class="c1"># Procesar las imagenes e incluirlos en una lista</span>
<span class="c1"># =============================================================</span>
<span class="c1"># Asignar método de estimación de LAI</span>
<span class="c1"># 0: Savi con l=0.1 </span>
<span class="c1"># 1: Savi con L=0.5 </span>
<span class="c1"># 2: Relación lineal NDVI - IAF: 2.1362*NDVI + 0.0869</span>
<span class="c1"># 3: Relación cuadrada NDVI - IAF : 2.3523*NDVI^2 - 1.9013*NDVI + 1.7714</span>
<span class="c1"># 4: Savi con L=0.5 y LAI=11*SAVI^3 </span>

<span class="n">lai_method</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">albedo_method</span> <span class="o">=</span> <span class="s1">&#39;0.254*B2 + 0.149*B3 + 0.147*B4 + 0.311*B5 + 0.103*B6 + 0.036*B7&#39;</span>

<span class="n">HR</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mi">82</span><span class="p">,</span> <span class="c1"># 0 &#39;2022-01-13&#39;</span>
    <span class="mi">81</span><span class="p">,</span> <span class="c1"># 1 &#39;2022-01-29&#39;</span>
    <span class="mi">83</span><span class="p">,</span> <span class="c1"># 2 &#39;2022-03-10&#39;</span>
    <span class="c1"># 72, # 3 &#39;2022-04-03&#39; # Sin dato</span>
    <span class="mi">70</span><span class="p">,</span> <span class="c1"># 4 &#39;2022-05-05&#39; # Sin dato </span>
    <span class="mi">68</span><span class="p">,</span> <span class="c1"># 5 &#39;2022-05-21&#39; # Sin dato</span>
    <span class="mi">65</span>  <span class="c1"># 6 &#39;2022-06-14&#39;</span>
<span class="p">]</span>

<span class="c1"># Lista en blanco que va a contener los resultados</span>
<span class="n">lista_imgprocesadas</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">img_id</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lista_ids</span><span class="p">):</span>

    <span class="c1"># Imagen Landsat mediante ID</span>
    <span class="n">img_ee</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">img_id</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">roi</span><span class="p">)</span>
    
    <span class="c1"># Procesar Radiación Neta (produce un dict)</span>
    <span class="n">img_procesada_dict</span> <span class="o">=</span> <span class="n">getRadiacionNeta</span><span class="p">(</span><span class="n">img_ee</span><span class="p">,</span> <span class="n">roi</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> 
                                           <span class="n">lai_method</span><span class="p">,</span> <span class="n">albedo_method</span><span class="p">,</span> <span class="n">HR</span><span class="p">[</span><span class="n">index</span><span class="p">])</span> <span class="c1"># roi: Ferreñafe</span>

    <span class="c1"># Recorte por regiones</span>
    <span class="n">img_procesada_dict</span><span class="p">[</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img_procesada_dict</span><span class="p">[</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">)</span>
    <span class="n">img_procesada_dict</span><span class="p">[</span><span class="s1">&#39;img_toa&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img_procesada_dict</span><span class="p">[</span><span class="s1">&#39;img_toa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">predios_bound</span><span class="p">)</span>

    <span class="c1"># Agregar a lista en blanco</span>
    <span class="n">lista_imgprocesadas</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img_procesada_dict</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Productos y Rn de imagen </span><span class="si">{</span><span class="n">img_procesada_dict</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2"> procesada! lai_method = </span><span class="si">{</span><span class="n">lai_method</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="n">n_imgs</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lista_imgprocesadas</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Productos y Rn de imagen 2022-01-13 procesada! lai_method = 4
Productos y Rn de imagen 2022-01-29 procesada! lai_method = 4
Productos y Rn de imagen 2022-03-10 procesada! lai_method = 4
Productos y Rn de imagen 2022-05-05 procesada! lai_method = 4
Productos y Rn de imagen 2022-05-21 procesada! lai_method = 4
Productos y Rn de imagen 2022-06-14 procesada! lai_method = 4
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Pixeles escogidos mediante comparación ndvi-temperatura</span>
<span class="c1"># Pixel frío</span>
<span class="n">list_coords_pixf1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78527</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598056</span><span class="p">],</span>  <span class="c1"># 0 &#39;2022-01-13&#39; n1: 50 n2: 10   [-79.785803, -6.598076] mejor albedo</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78472</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598345</span><span class="p">],</span>  <span class="c1"># 1 &#39;2022-01-29&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78445</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.596984</span><span class="p">],</span>  <span class="c1"># 2 &#39;2022-03-10&#39; n1: 50 n2: 5</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.779022</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.597242</span><span class="p">],</span> <span class="c1"># 3 &#39;2022-04-03&#39; n1: 80 n2: 10 Nuevo</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.776047</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.597519</span><span class="p">],</span> <span class="c1"># 4 &#39;2022-05-05&#39; n1: 40 n2: 10 Nuevo</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778976</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605092</span><span class="p">],</span> <span class="c1"># 5 &#39;2022-05-21&#39; n1: 50 n2: 10 Nuevo</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778737</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604828</span><span class="p">],</span> <span class="c1"># 6 &#39;2022-06-14&#39; n1: 50 n2: 5</span>
<span class="p">]</span>

<span class="c1"># Pixel caliente</span>
<span class="n">list_coords_pixc1</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78198</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.602693</span><span class="p">],</span>  <span class="c1"># 0 &#39;2022-01-13&#39; n1: 40 n2: 97 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778464</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605114</span><span class="p">],</span> <span class="c1"># 1 &#39;2022-01-29&#39; n1: 10 n2: 90</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.777924</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604045</span><span class="p">],</span> <span class="c1"># 2 &#39;2022-03-10&#39; n1: 4 n2: 75 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778463</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.603747</span><span class="p">],</span> <span class="c1"># 3 &#39;2022-04-03&#39; n1: 10 n2: 80  </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784448</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598642</span><span class="p">],</span> <span class="c1"># 4 &#39;2022-05-05&#39; n1: 25 n2: 75  </span>
    <span class="c1"># [-79.784966, -6.602174], # 4 &#39;2022-05-05&#39;  Prueba en zona de temperaturas altas</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.785537</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598398</span><span class="p">],</span> <span class="c1"># 5 &#39;2022-05-21&#39; n1: 30 n2: 80  </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784729</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.595629</span><span class="p">],</span> <span class="c1"># 6 &#39;2022-06-14&#39; n1: 10 n2: 80 </span>
<span class="p">]</span>

<span class="c1"># Pixeles escogidos mediante relación ndvi-albedo</span>
<span class="c1"># pixeles ndvi-albedo</span>
<span class="n">list_coords_pixf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.775487</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.601604</span><span class="p">],</span> <span class="c1"># 0 &#39;2022-01-13&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.785809</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598078</span><span class="p">],</span> <span class="c1"># 1 &#39;2022-01-29&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78445</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.596984</span><span class="p">],</span> <span class="c1"># 2 &#39;2022-03-10&#39; n1: 50 n2: 5  [-79.782536, -6.601574]</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.779022</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.597242</span><span class="p">],</span> <span class="c1"># 3 &#39;2022-04-03&#39; n1: 80 n2: 10  [-79.782545, -6.601342]</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778744</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604585</span><span class="p">],</span> <span class="c1"># 4 &#39;2022-05-05&#39; n1: 40 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778718</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604593</span><span class="p">],</span> <span class="c1"># 5 &#39;2022-05-21&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778739</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604574</span><span class="p">],</span> <span class="c1"># 6 &#39;2022-06-14&#39; n1: 50 n2: 5</span>
<span class="p">]</span>

<span class="c1"># Pixeles ndvi-albedo </span>
<span class="n">list_coords_pixc</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78198</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.602693</span><span class="p">],</span>  <span class="c1"># 0 &#39;2022-01-13&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778464</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605114</span><span class="p">],</span>  <span class="c1"># 1 &#39;2022-01-29&#39; n1: 50 n2: 10 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.777924</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604045</span><span class="p">],</span>  <span class="c1"># 2 &#39;2022-03-10&#39; n1: 50 n2: 5 [-79.778736, -6.604317]</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778468</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.603759</span><span class="p">],</span>  <span class="c1"># 3 &#39;2022-04-03&#39; n1: 80 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784448</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598642</span><span class="p">],</span> <span class="c1">#[-79.782006, -6.598379],  # 4 &#39;2022-05-05&#39; n1: 40 n2: 10 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.785537</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598398</span><span class="p">],</span> <span class="c1">#[-79.78228, -6.596453],   # 5 &#39;2022-05-21&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784729</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.595629</span><span class="p">]</span>  <span class="c1">#[-79.784462, -6.59621],   # 6 &#39;2022-06-14&#39; n1: 50 n2: 5</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># =============================================================</span>
<span class="c1"># Inputs iniciales</span>
<span class="c1"># =============================================================</span>

<span class="c1"># En caso de guardar los archivos</span>
<span class="n">save_files</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">carpeta_output</span> <span class="o">=</span> <span class="s1">&#39;output&#39;</span>

<span class="n">elev_station</span> <span class="o">=</span> <span class="mf">2.9</span> <span class="c1"># m</span>
<span class="n">n_iteraciones</span> <span class="o">=</span> <span class="mi">40</span> <span class="c1"># &lt;-- Establecer cantidad de iteraciones</span>

<span class="n">lista_fechas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;13-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;29-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;10-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;05-May&#39;</span><span class="p">,</span> <span class="s1">&#39;21-May&#39;</span><span class="p">,</span> <span class="s1">&#39;14-Jun&#39;</span><span class="p">]</span> <span class="c1"># &#39;03-Abr&#39;, </span>

<span class="c1"># =============================================================</span>
<span class="c1"># Datos de estación: Velocidad de viento y ET</span>
<span class="n">list_weather_st</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="mf">1.6</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.13</span><span class="p">],</span> <span class="c1"># 0 &#39;2022-01-13&#39; 1.6</span>
    <span class="p">[</span><span class="mf">1.6</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">],</span> <span class="c1"># 1 &#39;2022-01-29&#39;</span>
    <span class="p">[</span><span class="mf">3.2</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="c1"># 2 &#39;2022-03-10&#39; 3.2 (original)</span>
    <span class="c1"># [3.2*3.6, 0.17], # 3 &#39;2022-04-03&#39; 1.6</span>
    <span class="p">[</span><span class="mf">3.2</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="c1"># 4 &#39;2022-05-05&#39;</span>
    <span class="p">[</span><span class="mf">1.6</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.20</span><span class="p">],</span> <span class="c1"># 5 &#39;2022-05-21&#39;</span>
    <span class="p">[</span><span class="mf">1.6</span><span class="o">*</span><span class="mf">3.6</span><span class="p">,</span> <span class="mf">0.16</span><span class="p">]</span>  <span class="c1"># 6 &#39;2022-06-14&#39; (original)</span>
<span class="p">]</span> <span class="c1"># km/h</span>

<span class="c1"># Coordenadas previamente seleccionados (Pixel Frio)</span>
<span class="c1"># pixeles ndvi-albedo</span>
<span class="n">list_coords_pixf</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.775487</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.601604</span><span class="p">],</span> <span class="c1"># 0 &#39;2022-01-13&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.785809</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598078</span><span class="p">],</span> <span class="c1"># 1 &#39;2022-01-29&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78445</span><span class="p">,</span>  <span class="o">-</span><span class="mf">6.596984</span><span class="p">],</span> <span class="c1"># 2 &#39;2022-03-10&#39; n1: 50 n2: 5  [-79.782536, -6.601574]</span>
    <span class="c1"># [-79.779022, -6.597242], # 3 &#39;2022-04-03&#39; n1: 80 n2: 10  [-79.782545, -6.601342]</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778744</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604585</span><span class="p">],</span> <span class="c1"># 4 &#39;2022-05-05&#39; n1: 40 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778718</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604593</span><span class="p">],</span> <span class="c1"># 5 &#39;2022-05-21&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778739</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604574</span><span class="p">],</span> <span class="c1"># 6 &#39;2022-06-14&#39; n1: 50 n2: 5</span>
<span class="p">]</span>

<span class="c1"># Coordenadas previamente seleccionados (Pixel Caliente)</span>
<span class="c1"># Pixeles ndvi-albedo </span>
<span class="n">list_coords_pixc</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.78198</span> <span class="p">,</span> <span class="o">-</span><span class="mf">6.602693</span><span class="p">],</span>  <span class="c1"># 0 &#39;2022-01-13&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.778464</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605114</span><span class="p">],</span>  <span class="c1"># 1 &#39;2022-01-29&#39; n1: 50 n2: 10 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.777924</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.604045</span><span class="p">],</span>  <span class="c1"># 2 &#39;2022-03-10&#39; n1: 50 n2: 5 [-79.778736, -6.604317]</span>
    <span class="c1"># [-79.778468, -6.603759],  # 3 &#39;2022-04-03&#39; n1: 80 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784448</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598642</span><span class="p">],</span>  <span class="c1">#[-79.782006, -6.598379],  # 4 &#39;2022-05-05&#39; n1: 40 n2: 10 </span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.785537</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.598398</span><span class="p">],</span>  <span class="c1">#[-79.78228, -6.596453],   # 5 &#39;2022-05-21&#39; n1: 50 n2: 10</span>
    <span class="p">[</span><span class="o">-</span><span class="mf">79.784729</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.595629</span><span class="p">]</span>   <span class="c1">#[-79.784462, -6.59621],   # 6 &#39;2022-06-14&#39; n1: 50 n2: 5</span>
<span class="p">]</span>

<span class="c1"># =============================================================</span>
<span class="c1"># Procesamiento</span>
<span class="c1"># =============================================================</span>

<span class="n">lista_imgprocesadas_ET</span> <span class="o">=</span> <span class="p">[]</span> <span class="c1"># Lista vacía que almacenará resultados</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>

    <span class="c1"># Selección de datos</span>
    <span class="n">img_seleccionada</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">img_productos</span> <span class="o">=</span> <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span>
    <span class="n">d2</span> <span class="o">=</span> <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;d2&#39;</span><span class="p">]</span>
    <span class="n">fecha</span> <span class="o">=</span> <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Procesando imagen </span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1"> lai_method = </span><span class="si">{</span><span class="n">lai_method</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
    
    <span class="c1"># Generar estadísticas y guardar en DataFrame</span>
    <span class="n">img_productos_dict</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">img_productos</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">img_productos_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">img_productos_dict</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">)</span>

    <span class="c1"># =============================================================</span>
    <span class="c1"># 1. Establecer valores de pixel frío y caliente</span>
    <span class="c1"># Selección de datos mediante el&#39;index&#39;</span>
    <span class="c1"># =============================================================</span>

    <span class="n">filtrado_ws</span><span class="p">,</span> <span class="n">filtrado_et</span> <span class="o">=</span> <span class="n">list_weather_st</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>

    <span class="n">pixf_coord</span> <span class="o">=</span> <span class="n">list_coords_pixf</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">pixf_ee_coord</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">pixf_coord</span><span class="p">)</span>
    <span class="n">pix_f_values</span> <span class="o">=</span> <span class="n">get_pixel_values</span><span class="p">(</span><span class="n">pixf_ee_coord</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">img_productos</span><span class="p">)</span>

    <span class="n">pixc_coord</span> <span class="o">=</span> <span class="n">list_coords_pixc</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
    <span class="n">pixc_ee_coord</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Geometry</span><span class="o">.</span><span class="n">Point</span><span class="p">(</span><span class="n">pixc_coord</span><span class="p">)</span>
    <span class="n">pix_c_values</span> <span class="o">=</span> <span class="n">get_pixel_values</span><span class="p">(</span><span class="n">pixc_ee_coord</span><span class="p">,</span> <span class="n">d2</span><span class="p">,</span> <span class="n">img_productos</span><span class="p">)</span>

    <span class="c1"># Valores obtenidos por get_pixel_values</span>
    <span class="n">df_pixeles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">({</span><span class="s1">&#39;PixF&#39;</span><span class="p">:</span><span class="n">pix_f_values</span><span class="p">,</span> 
                                         <span class="s1">&#39;PixC&#39;</span><span class="p">:</span><span class="n">pix_c_values</span><span class="p">},</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;columns&#39;</span><span class="p">)</span>
    <span class="c1"># Añadir Longitud y Latitud a los pixeles</span>
    <span class="n">lonlat</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;PixF&#39;</span><span class="p">:</span> <span class="n">list_coords_pixf</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="s1">&#39;PixC&#39;</span><span class="p">:</span> <span class="n">list_coords_pixc</span><span class="p">[</span><span class="n">index</span><span class="p">]}</span>
    <span class="n">df_lonlat</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">lonlat</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Longitud&#39;</span><span class="p">,</span> <span class="s1">&#39;Latitud&#39;</span><span class="p">])</span>
    
    <span class="n">df_pixeles</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">df_pixeles</span><span class="p">,</span> <span class="n">df_lonlat</span><span class="p">])</span>
    
    <span class="c1"># Exportar datos de pixeles</span>
    <span class="n">df_pixeles</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_pixeles_selec.csv&#39;</span><span class="p">))</span> 
        
    <span class="c1"># =============================================================</span>
    <span class="c1"># 2. Flujo de calor sensible H - Proceso Iterativo</span>
    <span class="c1"># =============================================================</span>
    <span class="n">resultados_f</span><span class="p">,</span> <span class="n">resultados_c</span> <span class="o">=</span> <span class="n">parte_iterativa</span><span class="p">(</span><span class="n">n_iteraciones</span><span class="p">,</span>
                                                 <span class="n">elev_station</span><span class="p">,</span>
                                                 <span class="n">pix_f_values</span><span class="p">,</span> <span class="n">pix_c_values</span><span class="p">,</span> 
                                                 <span class="n">filtrado_ws</span><span class="p">,</span> <span class="n">filtrado_et</span><span class="p">)</span>

    <span class="n">resultados_f_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_f</span><span class="p">)</span>
    <span class="n">resultados_c_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">resultados_c</span><span class="p">)</span>
    <span class="c1"># display(resultados_c_df)</span>

    <span class="c1"># Guardar dataframe</span>
    <span class="n">resultados_f_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_iteraciones_pixf.csv&#39;</span><span class="p">))</span>
    <span class="n">resultados_c_df</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_iteraciones_pixc.csv&#39;</span><span class="p">))</span>

    <span class="c1"># Coeficientes a y b finales de selección de pixeles frío y caliente</span>
    <span class="n">coef_a</span> <span class="o">=</span> <span class="n">resultados_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;a_coef&#39;</span><span class="p">]</span>
    <span class="n">coef_b</span> <span class="o">=</span> <span class="n">resultados_f</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s1">&#39;b_coef&#39;</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">coef a: </span><span class="si">{</span><span class="n">coef_a</span><span class="si">}</span><span class="se">\n</span><span class="s1">coef b: </span><span class="si">{</span><span class="n">coef_b</span><span class="si">}</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="c1"># Guardar Gráfica 1x2 </span>
    <span class="n">grafica_coefs</span><span class="p">(</span><span class="n">resultados_f_df</span><span class="p">,</span> <span class="n">fecha</span><span class="p">,</span> <span class="n">coef_a</span><span class="p">,</span> <span class="n">coef_b</span><span class="p">,</span>
                  <span class="n">save_files</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_coefs.png&#39;</span><span class="p">))</span>

    <span class="c1"># =============================================================</span>
    <span class="c1"># 3. Componentes de balance de energía</span>
    <span class="c1"># =============================================================</span>

    <span class="c1"># 1. Rn</span>
    <span class="n">R_n</span> <span class="o">=</span> <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;img_Rn&#39;</span><span class="p">]</span>
    <span class="n">img_Rn</span> <span class="o">=</span> <span class="n">R_n</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;R_n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">)</span>

    <span class="c1"># 2. G</span>
    <span class="n">img_tempK</span> <span class="o">=</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Ts_k&#39;</span><span class="p">)</span>
    <span class="n">img_G</span> <span class="o">=</span> <span class="n">img_tempK</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;(Ts_K - 273.15)*(0.0038 + 0.0074*albedo)*(1-0.98*NDVI**4)&#39;</span><span class="p">,</span>
                                 <span class="p">{</span><span class="s1">&#39;Ts_K&#39;</span><span class="p">:</span> <span class="n">img_tempK</span><span class="p">,</span>
                                  <span class="s1">&#39;albedo&#39;</span><span class="p">:</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;albedo&#39;</span><span class="p">),</span>
                                  <span class="s1">&#39;NDVI&#39;</span><span class="p">:</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)}</span>
                                <span class="p">)</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="n">R_n</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;R_n&#39;</span><span class="p">))</span>

    <span class="c1"># 3. H</span>
    <span class="n">img_H</span> <span class="o">=</span> <span class="n">get_H_corregido</span><span class="p">(</span><span class="n">img_productos</span><span class="p">,</span> <span class="n">resultados_c</span><span class="p">,</span> <span class="n">dem</span><span class="p">,</span> <span class="n">elev_station</span><span class="p">)</span>
    <span class="n">img_H_stats</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">img_H</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="c1"># display(img_H_stats)</span>

    <span class="c1"># =============================================================</span>
    <span class="c1"># 4. Balance de energía: LE = Rn - G - H</span>
    <span class="c1"># Si H es superior a Rn, se producirán valores negativos de LE</span>
    <span class="c1"># =============================================================</span>
    <span class="n">img_LE</span> <span class="o">=</span> <span class="n">img_Rn</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;Rn - G - H&#39;</span><span class="p">,</span>
                               <span class="p">{</span><span class="s1">&#39;Rn&#39;</span><span class="p">:</span> <span class="n">img_Rn</span><span class="p">,</span>
                                <span class="s1">&#39;G&#39;</span><span class="p">:</span> <span class="n">img_G</span><span class="p">,</span>
                                <span class="s1">&#39;H&#39;</span><span class="p">:</span> <span class="n">img_H</span><span class="p">})</span>

    <span class="c1"># Filtrando valores negativos</span>
    <span class="c1"># img_LE_gt0 = img_LE.updateMask(img_LE.gt(0)) # Recorta</span>
    <span class="n">img_LE_gt0</span> <span class="o">=</span> <span class="n">img_LE</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">img_LE</span><span class="o">.</span><span class="n">lte</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span> <span class="mi">0</span><span class="p">)</span> <span class="c1"># Filtra</span>
    
    <span class="c1"># Unir los componentes en una sola imagen</span>
    <span class="n">img_compbalance</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">([</span><span class="n">img_Rn</span><span class="p">,</span> <span class="n">img_G</span><span class="p">,</span> <span class="n">img_H</span><span class="p">,</span> <span class="n">img_LE</span><span class="p">,</span> <span class="n">img_LE_gt0</span><span class="p">])</span><span class="o">.</span><span class="n">rename</span><span class="p">([</span><span class="s1">&#39;0_Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;1_G&#39;</span><span class="p">,</span> <span class="s1">&#39;2_H&#39;</span><span class="p">,</span> <span class="s1">&#39;3_LE&#39;</span><span class="p">,</span> <span class="s1">&#39;3_LE_vis&#39;</span><span class="p">])</span>
    <span class="n">img_compbalance_stats</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">img_compbalance</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">img_compbalance_stats_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">img_compbalance_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span> <span class="c1"># .round(3)</span>

    <span class="c1"># =============================================================</span>
    <span class="c1"># 5. Evapotranspiración del cultivo ETinst (mm/hr y mm/d)</span>
    <span class="c1"># =============================================================</span>

    <span class="c1"># ET (mm/hr)</span>
    <span class="n">img_lambda</span> <span class="o">=</span> <span class="n">img_tempK</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;(2.501 - 0.00236*(Ts - 273.15))*10**6&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;Ts&#39;</span><span class="p">:</span><span class="n">img_tempK</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
    <span class="n">img_ET_inst</span> <span class="o">=</span> <span class="n">img_LE</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;3600*img_LE/lambda&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;img_LE&#39;</span><span class="p">:</span> <span class="n">img_LE</span><span class="p">,</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="n">img_lambda</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span>
    <span class="n">img_ET_inst_pos</span> <span class="o">=</span> <span class="n">img_LE_gt0</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;3600*img_LE/lambda&#39;</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;img_LE&#39;</span><span class="p">:</span> <span class="n">img_LE_gt0</span><span class="p">,</span><span class="s1">&#39;lambda&#39;</span><span class="p">:</span> <span class="n">img_lambda</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;ET_pos&#39;</span><span class="p">)</span>
    
    <span class="c1"># ET (mm/día)      mm/hr * 24 hrs/dia = mm/dia</span>
    <span class="n">img_ET_inst</span> <span class="o">=</span> <span class="n">img_ET_inst</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span> 
    <span class="n">img_ET_inst_pos</span> <span class="o">=</span> <span class="n">img_ET_inst_pos</span><span class="o">.</span><span class="n">multiply</span><span class="p">(</span><span class="mi">24</span><span class="p">)</span>

    <span class="c1"># Generar estadísticas y guardar en dataframe</span>
    <span class="n">img_ET_inst_stats</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">img_ET_inst</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    <span class="n">img_ET_inst_stats_pos</span> <span class="o">=</span> <span class="n">get_stats</span><span class="p">(</span><span class="n">img_ET_inst_pos</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
    
    <span class="n">img_ET_inst_stats_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">img_ET_inst_stats</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span><span class="c1">#.round(3)</span>
    <span class="n">img_ET_inst_stats_pos_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">img_ET_inst_stats_pos</span><span class="p">,</span> <span class="n">orient</span><span class="o">=</span><span class="s1">&#39;index&#39;</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="s1">&#39;float&#39;</span><span class="p">)</span><span class="c1">#.round(3)</span>

    <span class="c1"># =============================================================</span>
    <span class="c1"># 6. Resultados</span>
    <span class="c1"># =============================================================</span>

    <span class="c1"># Generar dataframe final</span>
    <span class="n">lista_dfs</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">img_productos_df</span><span class="p">[[</span><span class="s1">&#39;Ts_c&#39;</span><span class="p">,</span> <span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">]],</span> 
        <span class="n">img_compbalance_stats_df</span><span class="p">,</span> 
        <span class="n">img_ET_inst_stats_df</span><span class="p">,</span>
        <span class="n">img_ET_inst_stats_pos_df</span>
    <span class="p">]</span>
    <span class="n">df_stats</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_dfs</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">df_stats</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_resultados.csv&#39;</span><span class="p">))</span>
    
    <span class="c1"># Visualización de resultados para comprobación</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Resultados:&#39;</span><span class="p">)</span>
    <span class="n">display</span><span class="p">(</span><span class="n">df_stats</span><span class="p">)</span>
    
    <span class="c1"># Unir imagenes de componentes y ET procesadas en una lista</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img_compbalance</span> <span class="c1"># ee.Image</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;img_ETinst&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">img_ET_inst</span>    <span class="c1"># ee.Image</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;pixeles_stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_pixeles</span>  <span class="c1"># df de valores solamente de pixeles </span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;stats&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df_stats</span>            <span class="c1"># df general de la imagen</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;pix_f&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultados_f_df</span>     <span class="c1"># df (f de frío)</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;pix_c&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">resultados_c_df</span>     <span class="c1"># df (c de caliente)</span>
    <span class="n">img_seleccionada</span><span class="p">[</span><span class="s1">&#39;pixeles&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;coef_a&#39;</span><span class="p">:</span><span class="n">coef_a</span><span class="p">,</span> <span class="s1">&#39;coef_b&#39;</span><span class="p">:</span><span class="n">coef_b</span><span class="p">}</span> 
    
    <span class="c1"># Finalmente agregamos cada imagen procesada a una lista</span>
    <span class="n">lista_imgprocesadas_ET</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">img_seleccionada</span><span class="p">)</span>

<span class="c1"># Coeficientes finales</span>
<span class="n">tabla_coefs</span><span class="p">(</span><span class="n">lista_imgprocesadas_ET</span><span class="p">,</span> <span class="n">n_imgs</span><span class="p">,</span> <span class="n">lista_fechas</span><span class="p">,</span> 
            <span class="n">save_files</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="s1">&#39;tabla_coeficientes.csv&#39;</span><span class="p">))</span>

<span class="c1"># lista_imgprocesadas_ET[index][&#39;stats&#39;] # Para ver los datos de las iteraciones por imagen</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-01-13 lai_method = 4


coef a: 0.15763394417501805
coef b: -40.51603651163816
</pre></div>
</div>
<img alt="_images/79c985d96e439c846315437d35bfa17e59babeca2ca2ea560f6f9bbb0ee154a3.png" src="_images/79c985d96e439c846315437d35bfa17e59babeca2ca2ea560f6f9bbb0ee154a3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>26.064854</td>
      <td>0.638488</td>
      <td>0.905927</td>
      <td>0.185278</td>
      <td>772.007719</td>
      <td>82.234554</td>
      <td>575.038528</td>
      <td>252.413985</td>
      <td>252.413985</td>
      <td>8.882268</td>
      <td>8.882268</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>20.429797</td>
      <td>0.173787</td>
      <td>0.026633</td>
      <td>0.108560</td>
      <td>685.840959</td>
      <td>64.051254</td>
      <td>467.382418</td>
      <td>154.407287</td>
      <td>154.418187</td>
      <td>5.436826</td>
      <td>5.437210</td>
    </tr>
    <tr>
      <th>median</th>
      <td>19.969761</td>
      <td>0.154227</td>
      <td>0.005551</td>
      <td>0.105695</td>
      <td>687.385429</td>
      <td>63.053955</td>
      <td>462.532576</td>
      <td>163.264781</td>
      <td>163.562905</td>
      <td>5.777835</td>
      <td>5.777835</td>
    </tr>
    <tr>
      <th>min</th>
      <td>17.866862</td>
      <td>-0.147715</td>
      <td>-0.003637</td>
      <td>0.060885</td>
      <td>595.838808</td>
      <td>51.978386</td>
      <td>437.699962</td>
      <td>-13.722458</td>
      <td>0.000000</td>
      <td>-0.483109</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>19.531407</td>
      <td>0.126766</td>
      <td>0.001463</td>
      <td>0.084236</td>
      <td>713.475019</td>
      <td>60.799171</td>
      <td>457.504966</td>
      <td>175.034006</td>
      <td>174.644913</td>
      <td>6.156311</td>
      <td>6.156311</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>1.565502</td>
      <td>0.121992</td>
      <td>0.067356</td>
      <td>0.026231</td>
      <td>29.247289</td>
      <td>4.911526</td>
      <td>18.474519</td>
      <td>47.731354</td>
      <td>47.694513</td>
      <td>1.676638</td>
      <td>1.675338</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-01-29 lai_method = 4


coef a: 0.36441732255415304
coef b: -99.52589082798454
</pre></div>
</div>
<img alt="_images/2b69ab04425feb1fd8bce6e4be05fe969c20cb7374057efd3234bba28aad4bf7.png" src="_images/2b69ab04425feb1fd8bce6e4be05fe969c20cb7374057efd3234bba28aad4bf7.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>21.477840</td>
      <td>0.758795</td>
      <td>1.877925</td>
      <td>0.193713</td>
      <td>769.870350</td>
      <td>67.980198</td>
      <td>763.911743</td>
      <td>190.013366</td>
      <td>190.013366</td>
      <td>6.667931</td>
      <td>6.667931</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>17.445788</td>
      <td>0.354347</td>
      <td>0.140550</td>
      <td>0.104555</td>
      <td>700.509783</td>
      <td>53.931980</td>
      <td>556.786132</td>
      <td>89.791671</td>
      <td>92.736874</td>
      <td>3.153451</td>
      <td>3.256933</td>
    </tr>
    <tr>
      <th>median</th>
      <td>17.516507</td>
      <td>0.330639</td>
      <td>0.043087</td>
      <td>0.103064</td>
      <td>701.418714</td>
      <td>55.137659</td>
      <td>552.982100</td>
      <td>96.932554</td>
      <td>96.496717</td>
      <td>3.405105</td>
      <td>3.390038</td>
    </tr>
    <tr>
      <th>min</th>
      <td>15.563630</td>
      <td>0.038919</td>
      <td>0.000039</td>
      <td>0.055395</td>
      <td>619.677496</td>
      <td>34.897378</td>
      <td>498.511708</td>
      <td>-174.222437</td>
      <td>0.000000</td>
      <td>-6.118508</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>17.639241</td>
      <td>0.345717</td>
      <td>0.012001</td>
      <td>0.093284</td>
      <td>706.495383</td>
      <td>56.109890</td>
      <td>554.990235</td>
      <td>116.942884</td>
      <td>0.000000</td>
      <td>4.100273</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>0.770599</td>
      <td>0.142571</td>
      <td>0.242455</td>
      <td>0.024200</td>
      <td>24.267049</td>
      <td>4.448359</td>
      <td>32.644874</td>
      <td>50.201987</td>
      <td>41.568810</td>
      <td>1.762488</td>
      <td>1.458946</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-03-10 lai_method = 4


coef a: 0.9405968001440479
coef b: -275.60206757217827
</pre></div>
</div>
<img alt="_images/7bd432b352679d4ace7d55b2722d8c6a1e6ea3022061698cbeb73d683e1cf88a.png" src="_images/7bd432b352679d4ace7d55b2722d8c6a1e6ea3022061698cbeb73d683e1cf88a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>29.919813</td>
      <td>0.813376</td>
      <td>2.122303</td>
      <td>0.188104</td>
      <td>735.731429</td>
      <td>89.702078</td>
      <td>979.393263</td>
      <td>167.826432</td>
      <td>167.826432</td>
      <td>5.940267</td>
      <td>5.940267</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>25.684918</td>
      <td>0.694646</td>
      <td>1.046459</td>
      <td>0.142720</td>
      <td>639.851290</td>
      <td>59.236592</td>
      <td>582.915545</td>
      <td>-2.300847</td>
      <td>24.661073</td>
      <td>-0.082310</td>
      <td>0.873047</td>
    </tr>
    <tr>
      <th>median</th>
      <td>25.546380</td>
      <td>0.728591</td>
      <td>1.085951</td>
      <td>0.147870</td>
      <td>636.548183</td>
      <td>57.637357</td>
      <td>574.126029</td>
      <td>2.139912</td>
      <td>3.531526</td>
      <td>0.062160</td>
      <td>0.116793</td>
    </tr>
    <tr>
      <th>min</th>
      <td>24.939735</td>
      <td>0.057734</td>
      <td>0.000088</td>
      <td>0.043423</td>
      <td>585.822866</td>
      <td>45.137698</td>
      <td>460.150098</td>
      <td>-456.387666</td>
      <td>0.000000</td>
      <td>-16.222986</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>25.387842</td>
      <td>0.759826</td>
      <td>0.003979</td>
      <td>0.154788</td>
      <td>626.459282</td>
      <td>54.627790</td>
      <td>589.925747</td>
      <td>41.986463</td>
      <td>0.005523</td>
      <td>0.436266</td>
      <td>0.000082</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>0.611619</td>
      <td>0.119466</td>
      <td>0.452783</td>
      <td>0.025791</td>
      <td>24.678610</td>
      <td>7.924443</td>
      <td>58.583589</td>
      <td>72.931438</td>
      <td>34.466568</td>
      <td>2.585274</td>
      <td>1.220264</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-05-05 lai_method = 4


coef a: 0.6634165785205943
coef b: -185.47412060570997
</pre></div>
</div>
<img alt="_images/9c7c34c763957dacfddc0cfb941f7b65d23a99ee1621d5402169ee3f3eebb428.png" src="_images/9c7c34c763957dacfddc0cfb941f7b65d23a99ee1621d5402169ee3f3eebb428.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>16.788747</td>
      <td>0.735566</td>
      <td>1.557676</td>
      <td>0.354990</td>
      <td>664.968419</td>
      <td>51.456978</td>
      <td>573.428419</td>
      <td>261.232885</td>
      <td>261.232885</td>
      <td>9.122667</td>
      <td>9.122667</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>13.510666</td>
      <td>0.465731</td>
      <td>0.410549</td>
      <td>0.185506</td>
      <td>590.678301</td>
      <td>38.855519</td>
      <td>421.147403</td>
      <td>130.675379</td>
      <td>130.869667</td>
      <td>4.571888</td>
      <td>4.578703</td>
    </tr>
    <tr>
      <th>median</th>
      <td>13.423193</td>
      <td>0.470679</td>
      <td>0.379058</td>
      <td>0.176675</td>
      <td>596.402704</td>
      <td>38.809884</td>
      <td>418.765206</td>
      <td>138.963941</td>
      <td>138.963941</td>
      <td>4.844798</td>
      <td>4.844798</td>
    </tr>
    <tr>
      <th>min</th>
      <td>11.343104</td>
      <td>0.219831</td>
      <td>0.015813</td>
      <td>0.086832</td>
      <td>445.952245</td>
      <td>28.354674</td>
      <td>301.140139</td>
      <td>-40.829905</td>
      <td>0.000000</td>
      <td>-1.433223</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>13.328941</td>
      <td>0.490262</td>
      <td>0.261924</td>
      <td>0.174856</td>
      <td>603.497477</td>
      <td>39.069605</td>
      <td>403.152075</td>
      <td>141.090082</td>
      <td>141.090082</td>
      <td>4.906808</td>
      <td>4.906808</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>0.661011</td>
      <td>0.091834</td>
      <td>0.229760</td>
      <td>0.034868</td>
      <td>31.106293</td>
      <td>3.068060</td>
      <td>32.553918</td>
      <td>47.308328</td>
      <td>46.722340</td>
      <td>1.654160</td>
      <td>1.633585</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-05-21 lai_method = 4


coef a: 0.1594355069966221
coef b: -41.31914734253402
</pre></div>
</div>
<img alt="_images/c240848b1cf2992d8ba94d43db21905b10f16cf2717ceebf8ad8a7ad71a5f3f3.png" src="_images/c240848b1cf2992d8ba94d43db21905b10f16cf2717ceebf8ad8a7ad71a5f3f3.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>21.653865</td>
      <td>0.630858</td>
      <td>0.835623</td>
      <td>0.269867</td>
      <td>615.574382</td>
      <td>61.092126</td>
      <td>448.628748</td>
      <td>197.080221</td>
      <td>197.080221</td>
      <td>6.920000</td>
      <td>6.920000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>18.738901</td>
      <td>0.317700</td>
      <td>0.120625</td>
      <td>0.194413</td>
      <td>538.986769</td>
      <td>52.137651</td>
      <td>389.851062</td>
      <td>96.998057</td>
      <td>96.998057</td>
      <td>3.410357</td>
      <td>3.410357</td>
    </tr>
    <tr>
      <th>median</th>
      <td>18.799113</td>
      <td>0.297891</td>
      <td>0.091757</td>
      <td>0.193755</td>
      <td>538.598321</td>
      <td>52.573582</td>
      <td>389.736091</td>
      <td>96.449291</td>
      <td>96.449291</td>
      <td>3.390767</td>
      <td>3.390767</td>
    </tr>
    <tr>
      <th>min</th>
      <td>15.447555</td>
      <td>0.141125</td>
      <td>0.004075</td>
      <td>0.117925</td>
      <td>474.921426</td>
      <td>37.139699</td>
      <td>363.763581</td>
      <td>12.013210</td>
      <td>12.013210</td>
      <td>0.423328</td>
      <td>0.423328</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>19.140552</td>
      <td>0.276203</td>
      <td>0.083768</td>
      <td>0.199771</td>
      <td>527.494004</td>
      <td>51.187848</td>
      <td>392.748390</td>
      <td>98.637431</td>
      <td>98.637431</td>
      <td>3.482335</td>
      <td>3.482335</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>0.989449</td>
      <td>0.065664</td>
      <td>0.101014</td>
      <td>0.023455</td>
      <td>23.434472</td>
      <td>3.289676</td>
      <td>10.872517</td>
      <td>32.047987</td>
      <td>32.047987</td>
      <td>1.124367</td>
      <td>1.124367</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Procesando imagen 2022-06-14 lai_method = 4


coef a: 0.1813076884619528
coef b: -49.33130770811982
</pre></div>
</div>
<img alt="_images/0462e717815566a9b98dfd97e9f79619ebb10973cb1f11870a097857644da6fb.png" src="_images/0462e717815566a9b98dfd97e9f79619ebb10973cb1f11870a097857644da6fb.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Resultados:
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
      <th>ET_pos</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>31.941024</td>
      <td>0.564996</td>
      <td>0.576829</td>
      <td>0.288857</td>
      <td>564.798679</td>
      <td>80.742470</td>
      <td>435.294427</td>
      <td>144.252041</td>
      <td>144.252041</td>
      <td>5.102792</td>
      <td>5.102792</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>28.697612</td>
      <td>0.264333</td>
      <td>0.077071</td>
      <td>0.177580</td>
      <td>490.403604</td>
      <td>71.139524</td>
      <td>397.187162</td>
      <td>22.076918</td>
      <td>26.469366</td>
      <td>0.782962</td>
      <td>0.939132</td>
    </tr>
    <tr>
      <th>median</th>
      <td>28.294680</td>
      <td>0.278310</td>
      <td>0.076069</td>
      <td>0.179211</td>
      <td>490.537089</td>
      <td>70.795727</td>
      <td>392.226710</td>
      <td>23.523451</td>
      <td>23.523451</td>
      <td>0.844172</td>
      <td>0.831412</td>
    </tr>
    <tr>
      <th>min</th>
      <td>24.168415</td>
      <td>0.085178</td>
      <td>0.000474</td>
      <td>0.085792</td>
      <td>399.780832</td>
      <td>55.509053</td>
      <td>348.755659</td>
      <td>-89.792881</td>
      <td>0.000000</td>
      <td>-3.195009</td>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>30.516081</td>
      <td>0.286231</td>
      <td>0.002408</td>
      <td>0.192837</td>
      <td>479.476816</td>
      <td>68.566290</td>
      <td>379.755179</td>
      <td>29.468284</td>
      <td>0.025740</td>
      <td>1.031612</td>
      <td>0.000794</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>1.619056</td>
      <td>0.089286</td>
      <td>0.081282</td>
      <td>0.037171</td>
      <td>27.243118</td>
      <td>4.133667</td>
      <td>18.259737</td>
      <td>30.704353</td>
      <td>23.444783</td>
      <td>1.089302</td>
      <td>0.830796</td>
    </tr>
  </tbody>
</table>
</div></div><div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>coef_a</th>
      <th>coef_b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>13-Ene</th>
      <td>0.157634</td>
      <td>-40.516037</td>
    </tr>
    <tr>
      <th>29-Ene</th>
      <td>0.364417</td>
      <td>-99.525891</td>
    </tr>
    <tr>
      <th>10-Mar</th>
      <td>0.940597</td>
      <td>-275.602068</td>
    </tr>
    <tr>
      <th>05-May</th>
      <td>0.663417</td>
      <td>-185.474121</td>
    </tr>
    <tr>
      <th>21-May</th>
      <td>0.159436</td>
      <td>-41.319147</td>
    </tr>
    <tr>
      <th>14-Jun</th>
      <td>0.181308</td>
      <td>-49.331308</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<section id="tablas">
<h3><span class="section-number">5.2.1. </span>Tablas<a class="headerlink" href="#tablas" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">tabla_pixeles</span><span class="p">(</span><span class="n">lista_imgprocesadas_ET</span><span class="p">,</span> 
              <span class="n">lista_fechas</span><span class="p">)</span>
              <span class="c1">#save_files=os.path.join(carpeta_output, &#39;tabla_pixeles_LAI4.csv&#39;))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Fecha</th>
      <th>Pixel</th>
      <th>Longitud</th>
      <th>Latitud</th>
      <th>NDVI</th>
      <th>Albedo</th>
      <th>Ts (K)</th>
      <th>a</th>
      <th>b</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>13-Ene</td>
      <td>P. Frío</td>
      <td>-79.775487</td>
      <td>-6.601604</td>
      <td>0.638243</td>
      <td>0.180693</td>
      <td>293.002699</td>
      <td>0.157634</td>
      <td>-40.516037</td>
    </tr>
    <tr>
      <th>1</th>
      <td>13-Ene</td>
      <td>P. Cal.</td>
      <td>-79.781980</td>
      <td>-6.602693</td>
      <td>0.134990</td>
      <td>0.164048</td>
      <td>299.214854</td>
      <td>0.157634</td>
      <td>-40.516037</td>
    </tr>
    <tr>
      <th>0</th>
      <td>29-Ene</td>
      <td>P. Frío</td>
      <td>-79.785809</td>
      <td>-6.598078</td>
      <td>0.758795</td>
      <td>0.193713</td>
      <td>288.863523</td>
      <td>0.364417</td>
      <td>-99.525891</td>
    </tr>
    <tr>
      <th>1</th>
      <td>29-Ene</td>
      <td>P. Cal.</td>
      <td>-79.778464</td>
      <td>-6.605114</td>
      <td>0.151251</td>
      <td>0.129899</td>
      <td>291.796699</td>
      <td>0.364417</td>
      <td>-99.525891</td>
    </tr>
    <tr>
      <th>0</th>
      <td>10-Mar</td>
      <td>P. Frío</td>
      <td>-79.784450</td>
      <td>-6.596984</td>
      <td>0.739550</td>
      <td>0.133570</td>
      <td>298.091980</td>
      <td>0.940597</td>
      <td>-275.602068</td>
    </tr>
    <tr>
      <th>1</th>
      <td>10-Mar</td>
      <td>P. Cal.</td>
      <td>-79.777924</td>
      <td>-6.604045</td>
      <td>0.167542</td>
      <td>0.061233</td>
      <td>300.230260</td>
      <td>0.940597</td>
      <td>-275.602068</td>
    </tr>
    <tr>
      <th>0</th>
      <td>05-May</td>
      <td>P. Frío</td>
      <td>-79.778744</td>
      <td>-6.604585</td>
      <td>0.723952</td>
      <td>0.172390</td>
      <td>285.992925</td>
      <td>0.663417</td>
      <td>-185.474121</td>
    </tr>
    <tr>
      <th>1</th>
      <td>05-May</td>
      <td>P. Cal.</td>
      <td>-79.784448</td>
      <td>-6.598642</td>
      <td>0.332702</td>
      <td>0.249469</td>
      <td>287.832641</td>
      <td>0.663417</td>
      <td>-185.474121</td>
    </tr>
    <tr>
      <th>0</th>
      <td>21-May</td>
      <td>P. Frío</td>
      <td>-79.778718</td>
      <td>-6.604593</td>
      <td>0.622461</td>
      <td>0.155652</td>
      <td>288.802154</td>
      <td>0.159436</td>
      <td>-41.319147</td>
    </tr>
    <tr>
      <th>1</th>
      <td>21-May</td>
      <td>P. Cal.</td>
      <td>-79.785537</td>
      <td>-6.598398</td>
      <td>0.263497</td>
      <td>0.251122</td>
      <td>294.067755</td>
      <td>0.159436</td>
      <td>-41.319147</td>
    </tr>
    <tr>
      <th>0</th>
      <td>14-Jun</td>
      <td>P. Frío</td>
      <td>-79.778739</td>
      <td>-6.604574</td>
      <td>0.556527</td>
      <td>0.159409</td>
      <td>297.335962</td>
      <td>0.181308</td>
      <td>-49.331308</td>
    </tr>
    <tr>
      <th>1</th>
      <td>14-Jun</td>
      <td>P. Cal.</td>
      <td>-79.784729</td>
      <td>-6.595629</td>
      <td>0.104390</td>
      <td>0.092475</td>
      <td>305.091024</td>
      <td>0.181308</td>
      <td>-49.331308</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tabla de rangos (2 decimales)</span>
<span class="k">def</span> <span class="nf">rangos</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
    
    <span class="n">promedio</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
    <span class="n">minimo</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
    <span class="n">maximo</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
    <span class="n">rangos_valores</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">promedio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">minimo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">maximo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">return</span> <span class="n">rangos_valores</span>

<span class="n">lista_nombres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;Albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Rn (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;G (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;H (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETc (mm d-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETc pos (mm d-1)&#39;</span><span class="p">]</span>
<span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;0_Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;1_G&#39;</span><span class="p">,</span> <span class="s1">&#39;2_H&#39;</span><span class="p">,</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span> <span class="s1">&#39;ET_pos&#39;</span><span class="p">]</span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;]</span>

<span class="c1"># Armar cuadro estadístico x(min-max)</span>
<span class="n">lista_resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="n">result_int</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">lista_variables</span><span class="p">:</span>
        <span class="n">valores</span> <span class="o">=</span> <span class="n">rangos</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
        <span class="n">result_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valores</span><span class="p">)</span>
    <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">result_int</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">lista_nombres</span><span class="p">)</span>
    <span class="n">lista_resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Unir dfs en uno solo</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_resultados</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># df_resultados.T para transpuesta</span>
<span class="c1"># df_resultados.to_csv(os.path.join(carpeta_output, &#39;tabla_resumen.csv&#39;))</span>
<span class="n">df_resultados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>13-Ene</th>
      <th>29-Ene</th>
      <th>10-Mar</th>
      <th>05-May</th>
      <th>21-May</th>
      <th>14-Jun</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NDVI</th>
      <td>0.17 (-0.15 - 0.64)</td>
      <td>0.35 (0.04 - 0.76)</td>
      <td>0.69 (0.06 - 0.81)</td>
      <td>0.47 (0.22 - 0.74)</td>
      <td>0.32 (0.14 - 0.63)</td>
      <td>0.26 (0.09 - 0.56)</td>
    </tr>
    <tr>
      <th>LAI</th>
      <td>0.03 (-0.00 - 0.91)</td>
      <td>0.14 (0.00 - 1.88)</td>
      <td>1.05 (0.00 - 2.12)</td>
      <td>0.41 (0.02 - 1.56)</td>
      <td>0.12 (0.00 - 0.84)</td>
      <td>0.08 (0.00 - 0.58)</td>
    </tr>
    <tr>
      <th>Albedo</th>
      <td>0.11 (0.06 - 0.19)</td>
      <td>0.10 (0.06 - 0.19)</td>
      <td>0.14 (0.04 - 0.19)</td>
      <td>0.19 (0.09 - 0.35)</td>
      <td>0.19 (0.12 - 0.27)</td>
      <td>0.18 (0.09 - 0.29)</td>
    </tr>
    <tr>
      <th>Rn (W m-2)</th>
      <td>685.84 (595.84 - 772.01)</td>
      <td>700.51 (619.68 - 769.87)</td>
      <td>639.85 (585.82 - 735.73)</td>
      <td>590.68 (445.95 - 664.97)</td>
      <td>538.99 (474.92 - 615.57)</td>
      <td>490.40 (399.78 - 564.80)</td>
    </tr>
    <tr>
      <th>G (W m-2)</th>
      <td>64.05 (51.98 - 82.23)</td>
      <td>53.93 (34.90 - 67.98)</td>
      <td>59.24 (45.14 - 89.70)</td>
      <td>38.86 (28.35 - 51.46)</td>
      <td>52.14 (37.14 - 61.09)</td>
      <td>71.14 (55.51 - 80.74)</td>
    </tr>
    <tr>
      <th>H (W m-2)</th>
      <td>467.38 (437.70 - 575.04)</td>
      <td>556.79 (498.51 - 763.91)</td>
      <td>582.92 (460.15 - 979.39)</td>
      <td>421.15 (301.14 - 573.43)</td>
      <td>389.85 (363.76 - 448.63)</td>
      <td>397.19 (348.76 - 435.29)</td>
    </tr>
    <tr>
      <th>ETc (mm d-1)</th>
      <td>5.44 (-0.48 - 8.88)</td>
      <td>3.15 (-6.12 - 6.67)</td>
      <td>-0.08 (-16.22 - 5.94)</td>
      <td>4.57 (-1.43 - 9.12)</td>
      <td>3.41 (0.42 - 6.92)</td>
      <td>0.78 (-3.20 - 5.10)</td>
    </tr>
    <tr>
      <th>ETc pos (mm d-1)</th>
      <td>5.44 (0.00 - 8.88)</td>
      <td>3.26 (0.00 - 6.67)</td>
      <td>0.87 (0.00 - 5.94)</td>
      <td>4.58 (0.00 - 9.12)</td>
      <td>3.41 (0.42 - 6.92)</td>
      <td>0.94 (0.00 - 5.10)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Tabla de rangos (2 decimales)</span>
<span class="k">def</span> <span class="nf">rangos</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">variable</span><span class="p">):</span>
    
    <span class="n">promedio</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;mean&#39;</span><span class="p">]</span>
    <span class="n">minimo</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">]</span>
    <span class="n">maximo</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="n">variable</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">]</span>
    <span class="n">rangos_valores</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">promedio</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">minimo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> - </span><span class="si">{</span><span class="n">maximo</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2">)&quot;</span>
    <span class="k">return</span> <span class="n">rangos_valores</span>

<span class="n">lista_nombres</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;Albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Rn (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;G (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;H (W m-2)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETc (mm d-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;ETc pos (mm d-1)&#39;</span><span class="p">]</span>
<span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;0_Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;1_G&#39;</span><span class="p">,</span> <span class="s1">&#39;2_H&#39;</span><span class="p">,</span> <span class="s1">&#39;ET&#39;</span><span class="p">,</span> <span class="s1">&#39;ET_pos&#39;</span><span class="p">]</span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;]</span>

<span class="c1"># Armar cuadro estadístico x(min-max)</span>
<span class="n">lista_resultados</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="n">result_int</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">variable</span> <span class="ow">in</span> <span class="n">lista_variables</span><span class="p">:</span>
        <span class="n">valores</span> <span class="o">=</span> <span class="n">rangos</span><span class="p">(</span><span class="n">index</span><span class="p">,</span> <span class="n">variable</span><span class="p">)</span>
        <span class="n">result_int</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valores</span><span class="p">)</span>
    <span class="n">dict_result</span> <span class="o">=</span> <span class="p">{</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">:</span> <span class="n">result_int</span><span class="p">}</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">dict_result</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="n">lista_nombres</span><span class="p">)</span>
    <span class="n">lista_resultados</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

<span class="c1"># Unir dfs en uno solo</span>
<span class="n">df_resultados</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">lista_resultados</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># df_resultados.T para transpuesta</span>
<span class="n">df_resultados</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="s1">&#39;tabla_resumen.csv&#39;</span><span class="p">))</span>
<span class="n">df_resultados</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>13-Ene</th>
      <th>29-Ene</th>
      <th>10-Mar</th>
      <th>03-Abr</th>
      <th>05-May</th>
      <th>21-May</th>
      <th>14-Jun</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>NDVI</th>
      <td>0.17 (-0.15 - 0.64)</td>
      <td>0.35 (0.04 - 0.76)</td>
      <td>0.69 (0.06 - 0.81)</td>
      <td>0.68 (0.24 - 0.77)</td>
      <td>0.47 (0.22 - 0.74)</td>
      <td>0.32 (0.14 - 0.63)</td>
      <td>0.26 (0.09 - 0.56)</td>
    </tr>
    <tr>
      <th>LAI</th>
      <td>0.03 (-0.00 - 0.91)</td>
      <td>0.14 (0.00 - 1.88)</td>
      <td>1.05 (0.00 - 2.12)</td>
      <td>1.10 (0.02 - 1.75)</td>
      <td>0.41 (0.02 - 1.56)</td>
      <td>0.12 (0.00 - 0.84)</td>
      <td>0.08 (0.00 - 0.58)</td>
    </tr>
    <tr>
      <th>Albedo</th>
      <td>0.11 (0.06 - 0.19)</td>
      <td>0.10 (0.06 - 0.19)</td>
      <td>0.14 (0.04 - 0.19)</td>
      <td>0.16 (0.10 - 0.20)</td>
      <td>0.19 (0.09 - 0.35)</td>
      <td>0.19 (0.12 - 0.27)</td>
      <td>0.18 (0.09 - 0.29)</td>
    </tr>
    <tr>
      <th>Rn (W m-2)</th>
      <td>685.84 (595.84 - 772.01)</td>
      <td>700.51 (619.68 - 769.87)</td>
      <td>639.85 (585.82 - 735.73)</td>
      <td>658.04 (612.08 - 729.25)</td>
      <td>590.68 (445.95 - 664.97)</td>
      <td>538.99 (474.92 - 615.57)</td>
      <td>490.40 (399.78 - 564.80)</td>
    </tr>
    <tr>
      <th>G (W m-2)</th>
      <td>64.05 (51.98 - 82.23)</td>
      <td>53.93 (34.90 - 67.98)</td>
      <td>59.24 (45.14 - 89.70)</td>
      <td>37.47 (30.44 - 58.66)</td>
      <td>38.86 (28.35 - 51.46)</td>
      <td>52.14 (37.14 - 61.09)</td>
      <td>71.14 (55.51 - 80.74)</td>
    </tr>
    <tr>
      <th>H (W m-2)</th>
      <td>467.38 (437.70 - 575.04)</td>
      <td>556.79 (498.51 - 763.91)</td>
      <td>582.92 (460.15 - 979.39)</td>
      <td>634.29 (509.94 - 932.18)</td>
      <td>421.15 (301.14 - 573.43)</td>
      <td>389.85 (363.76 - 448.63)</td>
      <td>397.19 (348.76 - 435.29)</td>
    </tr>
    <tr>
      <th>ETc (mm d-1)</th>
      <td>5.44 (-0.48 - 8.88)</td>
      <td>3.15 (-6.12 - 6.67)</td>
      <td>-0.08 (-16.22 - 5.94)</td>
      <td>-0.48 (-12.37 - 5.25)</td>
      <td>4.57 (-1.43 - 9.12)</td>
      <td>3.41 (0.42 - 6.92)</td>
      <td>0.78 (-3.20 - 5.10)</td>
    </tr>
    <tr>
      <th>ETc pos (mm d-1)</th>
      <td>5.44 (0.00 - 8.88)</td>
      <td>3.26 (0.00 - 6.67)</td>
      <td>0.87 (0.00 - 5.94)</td>
      <td>0.40 (0.00 - 5.25)</td>
      <td>4.58 (0.00 - 9.12)</td>
      <td>3.41 (0.42 - 6.92)</td>
      <td>0.94 (0.00 - 5.10)</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="revisar-imagenes">
<h3><span class="section-number">5.2.2. </span>Revisar imagenes<a class="headerlink" href="#revisar-imagenes" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">Ts_dem</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;max&#39;: {&#39;Ts_k&#39;: 305.36487286879725},
 &#39;mean&#39;: {&#39;Ts_k&#39;: 302.1130275605323},
 &#39;median&#39;: {&#39;Ts_k&#39;: 301.70086780486656},
 &#39;min&#39;: {&#39;Ts_k&#39;: 297.56598075457583},
 &#39;mode&#39;: {&#39;Ts_k&#39;: 300.6386654882428},
 &#39;stdDev&#39;: {&#39;Ts_k&#39;: 1.626703868351111}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">img_dT</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;max&#39;: {&#39;dT&#39;: 12.026943097944056},
 &#39;mean&#39;: {&#39;dT&#39;: 10.77485899463043},
 &#39;median&#39;: {&#39;dT&#39;: 10.615225002301734},
 &#39;min&#39;: {&#39;dT&#39;: 9.024073061397047},
 &#39;mode&#39;: {&#39;dT&#39;: 10.210838289210285},
 &#39;stdDev&#39;: {&#39;dT&#39;: 0.6263428488243965}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">air_pressureP</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;max&#39;: {&#39;constant&#39;: 100.82830832229618},
 &#39;mean&#39;: {&#39;constant&#39;: 100.75613845328498},
 &#39;median&#39;: {&#39;constant&#39;: 100.75770825535405},
 &#39;min&#39;: {&#39;constant&#39;: 100.66363711640493},
 &#39;mode&#39;: {&#39;constant&#39;: 100.76947215205384},
 &#39;stdDev&#39;: {&#39;constant&#39;: 0.024090406369826903}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">get_stats</span><span class="p">(</span><span class="n">air_dens_p</span><span class="p">,</span> <span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;max&#39;: {&#39;air_dens&#39;: 1.2060642042527694},
 &#39;mean&#39;: {&#39;air_dens&#39;: 1.1942541404650158},
 &#39;median&#39;: {&#39;air_dens&#39;: 1.1951444428962048},
 &#39;min&#39;: {&#39;air_dens&#39;: 1.1862133996762003},
 &#39;mode&#39;: {&#39;air_dens&#39;: 1.197318729007931},
 &#39;stdDev&#39;: {&#39;air_dens&#39;: 0.004087849553484041}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">air_pressureP</span> <span class="o">=</span> <span class="n">dem</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span>
    <span class="s1">&#39;101.3*( (293.15-0.0065*dem_elev)/293.15)**5.26&#39;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;dem_elev&#39;</span><span class="p">:</span> <span class="n">dem</span><span class="p">})</span>

<span class="n">air_dens_p</span> <span class="o">=</span> <span class="n">air_pressureP</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span>
    <span class="s1">&#39;1000*air_pressureP/(1.01*(air_tempK)*287)&#39;</span><span class="p">,</span>
    <span class="p">{</span><span class="s1">&#39;air_pressureP&#39;</span><span class="p">:</span> <span class="n">air_pressureP</span><span class="p">,</span>
     <span class="s1">&#39;air_tempK&#39;</span><span class="p">:</span> <span class="n">img_tempK</span><span class="o">.</span><span class="n">subtract</span><span class="p">(</span><span class="n">img_dT</span><span class="p">)})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;air_dens&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">img_tempk</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Ts_k&#39;</span><span class="p">)</span>
<span class="n">Ts_dem</span> <span class="o">=</span> <span class="n">img_tempK</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;img_tempK + Tlapse_rate/1000*(dem_elev-elev_station)&#39;</span><span class="p">,</span>
                              <span class="p">{</span><span class="s1">&#39;img_tempK&#39;</span><span class="p">:</span> <span class="n">img_tempK</span><span class="p">,</span>
                               <span class="s1">&#39;Tlapse_rate&#39;</span><span class="p">:</span> <span class="mf">6.5</span><span class="p">,</span>
                               <span class="s1">&#39;dem_elev&#39;</span><span class="p">:</span> <span class="n">dem</span><span class="p">,</span>
                               <span class="s1">&#39;elev_station&#39;</span><span class="p">:</span> <span class="n">elev_station</span><span class="p">})</span>
<span class="n">pixeles</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;pixeles&#39;</span><span class="p">]</span>

<span class="c1"># img_dT = b + a*Ts_dem</span>
<span class="n">img_dT</span> <span class="o">=</span> <span class="n">Ts_dem</span><span class="o">.</span><span class="n">expression</span><span class="p">(</span><span class="s1">&#39;b + a*Ts_dem&#39;</span><span class="p">,</span>
                           <span class="p">{</span><span class="s1">&#39;a&#39;</span><span class="p">:</span> <span class="n">pixeles</span><span class="p">[</span><span class="s1">&#39;coef_a&#39;</span><span class="p">],</span> <span class="s1">&#39;b&#39;</span><span class="p">:</span> <span class="n">pixeles</span><span class="p">[</span><span class="s1">&#39;coef_b&#39;</span><span class="p">],</span> <span class="s1">&#39;Ts_dem&#39;</span><span class="p">:</span> <span class="n">Ts_dem</span><span class="p">})</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="s1">&#39;dT&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># lista_imgprocesadas_ET[n_img][&#39;img_CompBalance&#39;]</span>

<span class="c1"># Mapas</span>
<span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">Ts_dem</span><span class="p">,</span> <span class="p">{},</span> <span class="s1">&#39;ts_dem&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "7394bc47d1b740a08cac0db808db5900", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="s1">&#39;d2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1.0004262213577246
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Visualizar imágenes</span>

<span class="c1"># 0 &#39;2022-01-13&#39;</span>
<span class="c1"># 1 &#39;2022-01-29&#39;</span>
<span class="c1"># 2 &#39;2022-03-10&#39;</span>
<span class="c1"># 3 &#39;2022-04-03&#39;</span>
<span class="c1"># 4 &#39;2022-05-05&#39;</span>
<span class="c1"># 5 &#39;2022-05-21&#39;</span>
<span class="c1"># 6 &#39;2022-06-14&#39;</span>

<span class="n">n_img</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># Mapas a visualizar</span>
<span class="n">img_temp</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;Ts_c&#39;</span><span class="p">)</span>
<span class="n">img_rgb</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_toa&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">predios_bound</span><span class="p">)</span>
<span class="n">fecha</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span>
<span class="n">img_albedo</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;albedo&#39;</span><span class="p">)</span>
<span class="n">img_lai</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;LAI&#39;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fecha</span><span class="p">)</span>

<span class="n">img_H</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;2_H&#39;</span><span class="p">)</span>
<span class="n">img_Rn</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;0_Rn&#39;</span><span class="p">)</span>
<span class="n">img_le</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;3_LE_vis&#39;</span><span class="p">)</span>

<span class="n">img_ndvi</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>

<span class="c1"># Seleccionar imagen ET</span>
<span class="n">img_ET</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;img_ETinst&#39;</span><span class="p">]</span>
<span class="n">img_ETpos</span> <span class="o">=</span> <span class="n">img_ET</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">img_ET</span><span class="o">.</span><span class="n">gte</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">img_ETnega</span> <span class="o">=</span> <span class="n">img_ET</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">img_ET</span><span class="o">.</span><span class="n">lt</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>

<span class="n">img_albedo_rangos</span> <span class="o">=</span> <span class="n">img_albedo</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">img_albedo</span><span class="o">.</span><span class="n">gte</span><span class="p">(</span><span class="mf">0.17</span><span class="p">))</span>

<span class="c1"># Parámetros de visualización</span>
<span class="n">paleta_ET</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;F5F5D9&quot;</span><span class="p">,</span><span class="s2">&quot;D1B586&quot;</span><span class="p">,</span><span class="s2">&quot;8BFF00&quot;</span><span class="p">,</span><span class="s2">&quot;52E0CF&quot;</span><span class="p">,</span><span class="s2">&quot;136400&quot;</span><span class="p">,</span><span class="s2">&quot;0000FF&quot;</span><span class="p">]</span>

<span class="n">vis_params_ndvi</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span><span class="c1">#lista_imgprocesadas_ET[n_img][&#39;stats&#39;][&#39;NDVI&#39;][&#39;min&#39;],</span>
                   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span><span class="c1">#lista_imgprocesadas_ET[n_img][&#39;stats&#39;][&#39;NDVI&#39;][&#39;max&#39;],</span>
                   <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="p">}</span>

<span class="n">vis_params_lai</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="c1">#cmp.get_palette(&#39;gray&#39;) </span>
<span class="p">}</span>
<span class="n">vis_params_alb</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="c1">#cmp.get_palette(&#39;gray&#39;) </span>
<span class="p">}</span>
<span class="n">vis_params_alb_rangos</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mf">0.17</span><span class="p">,</span>
    <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
    <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span> <span class="c1">#cmp.get_palette(&#39;gray&#39;) </span>
<span class="p">}</span>

<span class="n">vis_paramsp</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
               <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
               <span class="c1"># &#39;max&#39;: int(max_et), </span>
               <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">paleta_ET</span><span class="p">}</span> <span class="c1">#cmp.get_palette(&#39;Grays&#39;)} </span>

<span class="n">vis_paramset</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
               <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> 
               <span class="c1"># &#39;max&#39;: int(max_et), </span>
               <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">paleta_ET</span><span class="p">}</span> <span class="c1">#cmp.get_palette(&#39;Grays&#39;)}</span>

<span class="n">vis_paramsn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;ET&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>  
               <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> 
               <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;Reds_r&#39;</span><span class="p">)}</span> 

<span class="n">vis_paramst</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;Ts_c&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>  
               <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;Ts_c&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> 
               <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)}</span>  <span class="c1"># YlGnBu</span>

<span class="n">vis_params_le</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;3_LE_vis&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span>  
                 <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;3_LE_vis&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> 
                 <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="p">}</span><span class="c1">#cmp.get_palette(&#39;RdYlBu_r&#39;)}  # YlGnBu</span>

<span class="n">vis_params_H</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;2_H&#39;</span><span class="p">][</span><span class="s1">&#39;min&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">][</span><span class="s1">&#39;2_H&#39;</span><span class="p">][</span><span class="s1">&#39;max&#39;</span><span class="p">],</span> 
                <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;Grays&#39;</span><span class="p">)}</span>

<span class="n">display</span><span class="p">(</span><span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">n_img</span><span class="p">][</span><span class="s1">&#39;stats&#39;</span><span class="p">])</span>

<span class="c1"># Mapas</span>
<span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">,</span> <span class="n">vis_rgb</span><span class="p">,</span> <span class="s1">&#39;img_rgb&#39;</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_ndvi</span><span class="p">,</span> <span class="n">vis_params_ndvi</span><span class="p">,</span> <span class="s1">&#39;img_ndvi&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_albedo</span><span class="p">,</span> <span class="n">vis_params_alb</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_lai</span><span class="p">,</span> <span class="n">vis_params_lai</span><span class="p">,</span> <span class="s1">&#39;lai&#39;</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_ET</span><span class="p">,</span> <span class="n">vis_paramset</span><span class="p">,</span> <span class="s1">&#39;img_ET&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_ETpos</span><span class="p">,</span> <span class="n">vis_paramsp</span><span class="p">,</span> <span class="s1">&#39;img_ETpos&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_ETnega</span><span class="p">,</span> <span class="n">vis_paramsn</span><span class="p">,</span> <span class="s1">&#39;img_ETnega&#39;</span><span class="p">)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_H</span><span class="p">,</span> <span class="n">vis_params_H</span><span class="p">,</span> <span class="s1">&#39;img_H&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_le</span><span class="p">,</span> <span class="n">vis_params_le</span><span class="p">,</span> <span class="s1">&#39;img_le&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_temp</span><span class="p">,</span> <span class="n">vis_paramst</span><span class="p">,</span> <span class="s1">&#39;img_temp&#39;</span><span class="p">)</span>

<span class="c1"># Map.addLayer(img_albedo_rangos, vis_params_alb_rangos, &#39;albedo_gt17&#39;)</span>

<span class="c1"># Prueba: Selección de pixeles</span>
<span class="c1"># Map.addLayer(ee.Geometry.Point(list_coords_pixf1[n_img]), {}, &#39;Pixel F anterior&#39;)</span>
<span class="c1"># Map.addLayer(ee.Geometry.Point(list_coords_pixf[n_img]), {}, &#39;Pixel F&#39;)</span>
<span class="c1"># Map.addLayer(ee.Geometry.Point(list_coords_pixc1[n_img]), {}, &#39;Pixel C anterior&#39;)</span>
<span class="c1"># Map.addLayer(ee.Geometry.Point(list_coords_pixc[n_img]), {}, &#39;Pixel C&#39;)</span>

<span class="c1"># Map.addLayer(ee.Geometry.Point(), {}, &#39;Pixel C final&#39;)</span>

<span class="n">Map</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">vis_paramset</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">)</span> <span class="c1">#, label=&#39;ET&#39;)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2022-01-13
</pre></div>
</div>
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Ts_c</th>
      <th>NDVI</th>
      <th>LAI</th>
      <th>albedo</th>
      <th>0_Rn</th>
      <th>1_G</th>
      <th>2_H</th>
      <th>3_LE</th>
      <th>3_LE_vis</th>
      <th>ET</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>max</th>
      <td>26.066006</td>
      <td>0.638488</td>
      <td>0.922158</td>
      <td>0.185254</td>
      <td>772.328767</td>
      <td>82.277447</td>
      <td>578.031242</td>
      <td>251.982392</td>
      <td>251.982392</td>
      <td>8.867080</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>20.426264</td>
      <td>0.173787</td>
      <td>0.045677</td>
      <td>0.108548</td>
      <td>686.110537</td>
      <td>64.064258</td>
      <td>468.905068</td>
      <td>153.141211</td>
      <td>153.173034</td>
      <td>5.392227</td>
    </tr>
    <tr>
      <th>median</th>
      <td>19.968177</td>
      <td>0.154227</td>
      <td>0.000028</td>
      <td>0.105683</td>
      <td>687.494991</td>
      <td>63.070315</td>
      <td>463.461803</td>
      <td>163.369398</td>
      <td>162.708563</td>
      <td>5.722259</td>
    </tr>
    <tr>
      <th>min</th>
      <td>17.866862</td>
      <td>-0.147715</td>
      <td>0.000000</td>
      <td>0.060872</td>
      <td>596.081181</td>
      <td>51.980854</td>
      <td>438.532979</td>
      <td>-18.395543</td>
      <td>0.000000</td>
      <td>-0.648556</td>
    </tr>
    <tr>
      <th>mode</th>
      <td>19.529479</td>
      <td>0.126766</td>
      <td>0.000028</td>
      <td>0.084238</td>
      <td>696.470801</td>
      <td>62.051227</td>
      <td>457.485348</td>
      <td>174.871352</td>
      <td>174.470390</td>
      <td>6.152229</td>
    </tr>
    <tr>
      <th>stdDev</th>
      <td>1.565740</td>
      <td>0.121992</td>
      <td>0.104066</td>
      <td>0.026230</td>
      <td>29.253303</td>
      <td>4.916764</td>
      <td>19.228541</td>
      <td>48.402281</td>
      <td>48.296241</td>
      <td>1.700371</td>
    </tr>
  </tbody>
</table>
</div></div><script type="application/vnd.jupyter.widget-view+json">{"model_id": "ab8c2b711afb47af8a9a8011ed72e5ba", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">Map</span><span class="p">()</span>
<span class="n">Map</span><span class="o">.</span><span class="n">centerObject</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="mi">16</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_rgb</span><span class="p">,</span> <span class="n">vis_rgb</span><span class="p">,</span> <span class="s1">&#39;img_rgb&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_H</span><span class="p">,</span> <span class="n">vis_params_H</span><span class="p">,</span> <span class="s1">&#39;img_H&#39;</span><span class="p">)</span>
<span class="n">Map</span><span class="o">.</span><span class="n">addLayer</span><span class="p">(</span><span class="n">img_ETnega</span><span class="p">,</span> <span class="n">vis_paramsn</span><span class="p">,</span> <span class="s1">&#39;img_ETnega&#39;</span><span class="p">)</span>
<span class="n">Map</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<script type="application/vnd.jupyter.widget-view+json">{"model_id": "", "version_major": 2, "version_minor": 0}</script></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">Map</span><span class="o">.</span><span class="n">user_rois</span><span class="o">.</span><span class="n">geometry</span><span class="p">()</span><span class="o">.</span><span class="n">coordinates</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[-79.776576, -6.602948]
</pre></div>
</div>
</div>
</div>
<section id="lai">
<h4><span class="section-number">5.2.2.1. </span>LAI<a class="headerlink" href="#lai" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ndvi_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ffffff&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;ce7e45&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;fad163&#39;</span><span class="p">,</span>
             <span class="s2">&quot;8BFF00&quot;</span><span class="p">,</span>
             <span class="s1">&#39;74a909&#39;</span><span class="p">,</span>
             <span class="s1">&#39;3a7405&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;1a3b03&#39;</span><span class="p">,</span>
             <span class="s2">&quot;0000FF&quot;</span><span class="p">]</span>  <span class="c1"># -0.2 - 1  &#39;0048fb&#39;,</span>

<span class="n">lai_paleta</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ffffff&#39;</span><span class="p">,</span> <span class="s1">&#39;ce7e45&#39;</span><span class="p">,</span> <span class="s1">&#39;df923d&#39;</span><span class="p">,</span> <span class="s1">&#39;f1b555&#39;</span><span class="p">,</span> <span class="s1">&#39;fcd163&#39;</span><span class="p">,</span> <span class="s1">&#39;99b718&#39;</span><span class="p">,</span> <span class="s1">&#39;74a901&#39;</span><span class="p">,</span>
    <span class="s1">&#39;66a000&#39;</span><span class="p">,</span> <span class="s1">&#39;529400&#39;</span><span class="p">,</span> <span class="s1">&#39;3e8601&#39;</span><span class="p">,</span> <span class="s1">&#39;207401&#39;</span><span class="p">,</span> <span class="s1">&#39;056201&#39;</span><span class="p">,</span> <span class="s1">&#39;004c00&#39;</span><span class="p">,</span> <span class="s1">&#39;023b01&#39;</span><span class="p">,</span>
    <span class="s1">&#39;012e01&#39;</span><span class="p">,</span> <span class="s1">&#39;011d01&#39;</span><span class="p">,</span> <span class="s1">&#39;011301&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ts_c&#39;</span><span class="p">]</span>
<span class="n">vis_params_lai</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>  <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">lai_paleta</span><span class="p">}</span>
<span class="n">index</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">img_productos</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="n">get_grafica_cartoee_color</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> 
                          <span class="n">vis_params_lai</span><span class="p">,</span>      
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                          <span class="n">text</span><span class="o">=</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> 
                          <span class="n">title_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span> <span class="s1">&#39;IAF&#39;</span><span class="p">,</span> <span class="c1">#&#39;ETc ($mm\;d^{-1}$)&#39;, </span>
                          <span class="c1"># save_fig=os.path.join(carpeta_output, f&quot;ET_{lista_imgprocesadas[-1][&#39;fecha&#39;]}&quot;),</span>
                          <span class="n">nogrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">scale_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/0017266582247d23284b7e72633db01127aa007653b4e54ccff140a0b3b3db37.png" src="_images/0017266582247d23284b7e72633db01127aa007653b4e54ccff140a0b3b3db37.png" />
</div>
</div>
</section>
</section>
<section id="graficas-con-cartoee">
<h3><span class="section-number">5.2.3. </span>Gráficas con cartoee<a class="headerlink" href="#graficas-con-cartoee" title="Link to this heading">#</a></h3>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">geemap</span> <span class="kn">import</span> <span class="n">cartoee</span>        <span class="c1"># Elaboración de gráficas</span>
<span class="kn">import</span> <span class="nn">cartopy.crs</span> <span class="k">as</span> <span class="nn">ccrs</span>        <span class="c1"># Importar sistema de coordenadas para gráficas</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">lista_fechas</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;]
</pre></div>
</div>
</div>
</div>
<section id="grafica-ndvi-iaf-albedo-ts">
<h4><span class="section-number">5.2.3.1. </span>Gráfica NDVI-IAF-Albedo-Ts<a class="headerlink" href="#grafica-ndvi-iaf-albedo-ts" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">cmap_albedo</span> <span class="o">=</span> <span class="p">[</span>
  <span class="s1">&#39;#d71a18&#39;</span><span class="p">,</span> <span class="c1"># 0.00 - 0.05</span>
  <span class="s1">&#39;#ea603c&#39;</span><span class="p">,</span> <span class="c1"># 0.05 - 0.10</span>
  <span class="s1">&#39;#f8af64&#39;</span><span class="p">,</span> <span class="c1"># 0.10 - 0.15</span>
  <span class="s1">&#39;#ffd293&#39;</span><span class="p">,</span> <span class="c1"># 0.15 - 0.20</span>
  <span class="s1">&#39;#fffebd&#39;</span><span class="p">,</span> <span class="c1"># 0.20 - 0.25</span>
  <span class="s1">&#39;#d1ebcd&#39;</span><span class="p">,</span> <span class="c1"># 0.25 - 0.30</span>
<span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># cmap_ndvi = [&#39;ffffff&#39;, </span>
<span class="c1">#              &#39;ce7e45&#39;, &#39;df923d&#39;, &#39;f1b555&#39;,</span>
<span class="c1">#              &#39;74a909&#39;,</span>
<span class="c1">#              &#39;3a7405&#39;, </span>
<span class="c1">#              &#39;1a3b03&#39;]</span>

<span class="c1"># cmap_ndvi2 = [&#39;ffffff&#39;, </span>
<span class="c1">#              &#39;ce7e45&#39;, &#39;df923d&#39;, &#39;f1b555&#39;,</span>
<span class="c1">#              &#39;99b718&#39;, &#39;74a901&#39;, &#39;66a000&#39;, &#39;529400&#39;]</span>

<span class="c1"># cmap_lai = [&#39;ffffff&#39;, </span>
<span class="c1">#              &#39;ce7e45&#39;,&#39;ce7e45&#39;, </span>
<span class="c1">#              &#39;fad163&#39;,&#39;fad163&#39;,</span>
<span class="c1">#              &#39;74a909&#39;,&#39;74a909&#39;,</span>
<span class="c1">#              &#39;3a7405&#39;,&#39;3a7405&#39;, </span>
<span class="c1">#              &#39;1a3b03&#39;,&#39;1a3b03&#39;]  # -0.2 - 1  &#39;0048fb&#39;,</span>

<span class="c1"># # paleta de Earth Engine</span>
<span class="c1"># cmap_lai2 = [</span>
<span class="c1">#   # &#39;ffffff&#39;, </span>
<span class="c1">#              &#39;ce7e45&#39;, &#39;df923d&#39;, &#39;f1b555&#39;, &#39;fcd163&#39;, </span>
<span class="c1">#              &#39;99b718&#39;, &#39;74a901&#39;, &#39;66a000&#39;, &#39;529400&#39;, &#39;3e8601&#39;, </span>
<span class="c1">#              &#39;207401&#39;, &#39;056201&#39;, &#39;004c00&#39;, &#39;023b01&#39;, &#39;012e01&#39;, </span>
<span class="c1">#              &#39;011d01&#39;, &#39;011301&#39;]</span>

<span class="c1"># cmap_lai3 = [&#39;3b0200&#39;, &#39;977705&#39;, &#39;ca9f06&#39;, &#39;ffca09&#39;, &#39;006a03&#39;, &#39;003b02&#39;]</span>

<span class="c1"># cmap_lai4 = [&#39;ffffff&#39;, </span>
<span class="c1">#              &#39;ce7e45&#39;, &#39;df923d&#39;, &#39;f1b555&#39;,</span>
<span class="c1">#              &#39;fad163&#39;, &#39;74a909&#39;, &#39;3a7405&#39;, &#39;1a3b03&#39;] </span>

<span class="c1"># lai_paleta = [&#39;ffffff&#39;, </span>
<span class="c1">#               &#39;ce7e45&#39;, &#39;df923d&#39;, &#39;f1b555&#39;, &#39;fcd163&#39;, &#39;99b718&#39;, &#39;74a901&#39;,</span>
<span class="c1">#     &#39;66a000&#39;, &#39;529400&#39;, &#39;3e8601&#39;, &#39;207401&#39;, &#39;056201&#39;, &#39;004c00&#39;, &#39;023b01&#39;,</span>
<span class="c1">#     &#39;012e01&#39;, &#39;011d01&#39;, &#39;011301&#39;]</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Listas para iteraciones </span>
<span class="c1"># Diccionarios de visualización</span>

<span class="n">ndvi_cmap</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ffffff&#39;</span><span class="p">,</span> <span class="s1">&#39;ce7e45&#39;</span><span class="p">,</span> <span class="s1">&#39;fad163&#39;</span><span class="p">,</span> <span class="s1">&#39;74a909&#39;</span><span class="p">,</span> <span class="s1">&#39;3a7405&#39;</span><span class="p">,</span> <span class="s1">&#39;1a3b03&#39;</span><span class="p">]</span>
<span class="n">ndvi_cmap2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;ce7e45&#39;</span><span class="p">,</span> <span class="s1">&#39;fad163&#39;</span><span class="p">,</span> <span class="s1">&#39;74a909&#39;</span><span class="p">,</span> <span class="s1">&#39;3a7405&#39;</span><span class="p">,</span> <span class="s1">&#39;1a3b03&#39;</span><span class="p">]</span>

<span class="n">vis_params_ndvi</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> 
                   <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> 
                   <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="p">}</span> <span class="c1"># cmp.get_palette(&#39;RdYlGn&#39;), ndvi_cmap</span>

<span class="n">vis_params_alb</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                  <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.30</span><span class="p">,</span>
                  <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;afmhot&#39;</span><span class="p">)}</span>

<span class="n">vis_params_ts</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">,</span> <span class="c1">#img_productos_dict[&#39;min&#39;][&#39;Ts_c&#39;],</span>
                 <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">35</span><span class="p">,</span> <span class="c1">#img_productos_dict[&#39;max&#39;][&#39;Ts_c&#39;],</span>
                 <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)}</span>

<span class="n">vis_params_lai</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>  
                  <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> 
                  <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap2</span><span class="p">}</span> <span class="c1"># RdYlGn_r, afmhot, turbo_r</span>

<span class="n">lista_paletas</span> <span class="o">=</span> <span class="p">[</span><span class="n">vis_params_ndvi</span><span class="p">,</span> <span class="n">vis_params_lai</span><span class="p">,</span> <span class="n">vis_params_alb</span><span class="p">,</span> <span class="n">vis_params_ts</span><span class="p">]</span>
<span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;LAI&#39;</span><span class="p">,</span> <span class="s1">&#39;albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ts_c&#39;</span><span class="p">]</span>
<span class="n">lista_etiquetas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> <span class="s1">&#39;IAF&#39;</span><span class="p">,</span> <span class="s1">&#39;Albedo&#39;</span><span class="p">,</span> <span class="s1">&#39;Ts (°C)&#39;</span><span class="p">]</span> 

<span class="n">save_filename</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># None para no guardar</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>  
<span class="c1"># for index in [5]:  </span>
    
    <span class="c1"># Selección de imagenes Landsat: 0 1 Enero, 2 Marzo, 3 Junio</span>
    <span class="n">img_productos</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span>
    <span class="n">fecha</span> <span class="o">=</span> <span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span>
    
    <span class="c1"># --------------------------------------------------------------------</span>
    <span class="c1"># Elaboración de gráfica</span>
    <span class="c1"># --------------------------------------------------------------------</span>
    
    <span class="n">extent</span> <span class="o">=</span> <span class="mf">0.0005</span>
    <span class="n">zoom_region</span> <span class="o">=</span> <span class="p">[</span>
        <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="n">extent</span>
    <span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

    <span class="c1"># Fecha ubicado a la izquierda</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.7872</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> 
    
    <span class="n">left</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="c1"># 0.875</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># 0.02</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mf">0.325</span> <span class="c1"># 0.125</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="mi">1000</span>    
    
    <span class="n">extent1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">+</span><span class="mi">12</span><span class="o">*</span><span class="n">extent</span>
    <span class="n">extent2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">extent</span>
    
    <span class="k">if</span> <span class="n">index</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                              <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> 
                              <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> 
                              <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> 
                              <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1"># lista_vispaletas conjunto de vis</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>      
        <span class="c1"># 1 NDVI</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="o">-</span><span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.75</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span>
                             <span class="c1"># discrete=True,</span>
                             <span class="c1"># spacing=&#39;proportional&#39;</span>
                            <span class="p">)</span>                       
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 2 LAI</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                             <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> 
                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> 
                             <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.38</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
                             <span class="c1"># discrete=True,</span>
                             <span class="c1"># spacing=&#39;proportional&#39;</span>
                            <span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 3 Albedo</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                             <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> 
                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> 
                             <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.56</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span> 
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.17</span><span class="p">,</span> <span class="mf">0.25</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">])</span> <span class="c1"># &lt;--- Asignación de ticks para Albedo</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 4 Temperatura</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.74</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="c1"># Guardar</span>
    <span class="k">if</span> <span class="n">save_filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">img_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Productos_</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">.png&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="n">img_name</span><span class="p">),</span> 
                    <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">.1</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">500</span><span class="p">);</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/cf95925514ba21037caba4251bfb41247888e9d03007e3daed3536bc8774fffa.png" src="_images/cf95925514ba21037caba4251bfb41247888e9d03007e3daed3536bc8774fffa.png" />
<img alt="_images/45b8db5a857787d1d2a054f4fcef5b8e5ea6b8999a665b83ed58d58d01acd662.png" src="_images/45b8db5a857787d1d2a054f4fcef5b8e5ea6b8999a665b83ed58d58d01acd662.png" />
<img alt="_images/49931cb9522019cfd3842882358c2b4015fdd4ff4f7cbf40f4032a62d463d0a2.png" src="_images/49931cb9522019cfd3842882358c2b4015fdd4ff4f7cbf40f4032a62d463d0a2.png" />
<img alt="_images/d121f18bd6775816f876afc8d50e08407974bc5f7a1f10db866ce2c1e2d453ed.png" src="_images/d121f18bd6775816f876afc8d50e08407974bc5f7a1f10db866ce2c1e2d453ed.png" />
<img alt="_images/86117e5c572c5abae2721833731c197549ab41522ff44d5b7887cefac3e9cf0e.png" src="_images/86117e5c572c5abae2721833731c197549ab41522ff44d5b7887cefac3e9cf0e.png" />
<img alt="_images/536020eac6c280c0aebb49240050b4be5fffb84de279ad6d6c80359d7b7be1e8.png" src="_images/536020eac6c280c0aebb49240050b4be5fffb84de279ad6d6c80359d7b7be1e8.png" />
</div>
</div>
</section>
<section id="grafica-componentes-balance-radiacion">
<h4><span class="section-number">5.2.3.2. </span>Gráfica Componentes Balance Radiación<a class="headerlink" href="#grafica-componentes-balance-radiacion" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;2_H&#39;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">get_stats</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13-Ene
{&#39;max&#39;: {&#39;2_H&#39;: 575.0385282698877},
 &#39;mean&#39;: {&#39;2_H&#39;: 467.54977663232603},
 &#39;median&#39;: {&#39;2_H&#39;: 462.53257645714916},
 &#39;min&#39;: {&#39;2_H&#39;: 437.6999618221012},
 &#39;mode&#39;: {&#39;2_H&#39;: 456.54462256183325},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 18.59063540600532}}
29-Ene
{&#39;max&#39;: {&#39;2_H&#39;: 763.911743229514},
 &#39;mean&#39;: {&#39;2_H&#39;: 557.1888752518483},
 &#39;median&#39;: {&#39;2_H&#39;: 552.9745350934287},
 &#39;min&#39;: {&#39;2_H&#39;: 498.51170820462056},
 &#39;mode&#39;: {&#39;2_H&#39;: 554.9907170484788},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 32.86242716728654}}
10-Mar
{&#39;max&#39;: {&#39;2_H&#39;: 979.3932628388465},
 &#39;mean&#39;: {&#39;2_H&#39;: 583.9260462882357},
 &#39;median&#39;: {&#39;2_H&#39;: 574.2205615983075},
 &#39;min&#39;: {&#39;2_H&#39;: 460.1500982338207},
 &#39;mode&#39;: {&#39;2_H&#39;: 589.9047692874761},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 59.91105552837284}}
05-May
{&#39;max&#39;: {&#39;2_H&#39;: 577.4254352513208},
 &#39;mean&#39;: {&#39;2_H&#39;: 421.5636022883774},
 &#39;median&#39;: {&#39;2_H&#39;: 418.7316955960612},
 &#39;min&#39;: {&#39;2_H&#39;: 301.1401387658011},
 &#39;mode&#39;: {&#39;2_H&#39;: 403.139978234861},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 33.202943620188464}}
21-May
{&#39;max&#39;: {&#39;2_H&#39;: 448.585578820703},
 &#39;mean&#39;: {&#39;2_H&#39;: 389.9295547812795},
 &#39;median&#39;: {&#39;2_H&#39;: 389.7407074936652},
 &#39;min&#39;: {&#39;2_H&#39;: 363.7635812555569},
 &#39;mode&#39;: {&#39;2_H&#39;: 392.7523250652665},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 10.979788981275668}}
14-Jun
{&#39;max&#39;: {&#39;2_H&#39;: 435.2944273964382},
 &#39;mean&#39;: {&#39;2_H&#39;: 397.19976753886453},
 &#39;median&#39;: {&#39;2_H&#39;: 392.2418819171556},
 &#39;min&#39;: {&#39;2_H&#39;: 348.7556594196124},
 &#39;mode&#39;: {&#39;2_H&#39;: 379.75864360354205},
 &#39;stdDev&#39;: {&#39;2_H&#39;: 18.253365112262067}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;0_Rn&#39;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">get_stats</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13-Ene
{&#39;max&#39;: {&#39;0_Rn&#39;: 772.0077193208372},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 685.8409591609827},
 &#39;median&#39;: {&#39;0_Rn&#39;: 687.385429229218},
 &#39;min&#39;: {&#39;0_Rn&#39;: 595.8388078712111},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 713.4750185693233},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 29.247288514140795}}
29-Ene
{&#39;max&#39;: {&#39;0_Rn&#39;: 769.8703497156289},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 700.5097828381206},
 &#39;median&#39;: {&#39;0_Rn&#39;: 701.4187141783449},
 &#39;min&#39;: {&#39;0_Rn&#39;: 619.6774958773267},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 706.495382502436},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 24.267048733295145}}
10-Mar
{&#39;max&#39;: {&#39;0_Rn&#39;: 735.7314294163416},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 639.8512904216018},
 &#39;median&#39;: {&#39;0_Rn&#39;: 636.5481826265141},
 &#39;min&#39;: {&#39;0_Rn&#39;: 585.8228656736294},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 626.4592821697336},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 24.67861008646526}}
05-May
{&#39;max&#39;: {&#39;0_Rn&#39;: 664.9684194726657},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 590.6783008514083},
 &#39;median&#39;: {&#39;0_Rn&#39;: 596.4027037252724},
 &#39;min&#39;: {&#39;0_Rn&#39;: 445.9522454123453},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 603.4974769218619},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 31.106293315299816}}
21-May
{&#39;max&#39;: {&#39;0_Rn&#39;: 615.5743824971656},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 538.9867694948899},
 &#39;median&#39;: {&#39;0_Rn&#39;: 538.5983208213386},
 &#39;min&#39;: {&#39;0_Rn&#39;: 474.9214260021855},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 527.4940042279102},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 23.43447197560489}}
14-Jun
{&#39;max&#39;: {&#39;0_Rn&#39;: 564.7986792169385},
 &#39;mean&#39;: {&#39;0_Rn&#39;: 490.40360407042226},
 &#39;median&#39;: {&#39;0_Rn&#39;: 490.53708919381927},
 &#39;min&#39;: {&#39;0_Rn&#39;: 399.78083225138016},
 &#39;mode&#39;: {&#39;0_Rn&#39;: 479.4768161185291},
 &#39;stdDev&#39;: {&#39;0_Rn&#39;: 27.24311784543094}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
    <span class="n">img</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;3_LE_vis&#39;</span><span class="p">)</span>
    <span class="n">pprint</span><span class="p">(</span><span class="n">get_stats</span><span class="p">(</span><span class="n">img</span><span class="p">,</span> <span class="n">geometry</span><span class="o">=</span><span class="n">predios_agricolas</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mi">30</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>13-Ene
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 252.41398470460456},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 154.41818665604137},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 163.56290470334088},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 174.64491252515933},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 47.69451282704867}}
29-Ene
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 190.01336594536315},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 92.73687448628426},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 96.49671689850128},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 41.56880980794943}}
10-Mar
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 167.8264316155961},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 24.661073483757516},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 3.5315259149952434},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 0.005522966123425703},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 34.4665678882507}}
05-May
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 261.23288535996505},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 130.86966729476663},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 138.9639409649285},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 141.09008150887334},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 46.722339693818306}}
21-May
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 197.0802212320669},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 96.9980568435426},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 96.44929115034338},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 12.01321038891814},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 98.63743147285275},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 32.04798745128601}}
14-Jun
{&#39;max&#39;: {&#39;3_LE_vis&#39;: 144.2520410475127},
 &#39;mean&#39;: {&#39;3_LE_vis&#39;: 26.469365708278435},
 &#39;median&#39;: {&#39;3_LE_vis&#39;: 23.523450503302076},
 &#39;min&#39;: {&#39;3_LE_vis&#39;: 0},
 &#39;mode&#39;: {&#39;3_LE_vis&#39;: 0.025739503375175343},
 &#39;stdDev&#39;: {&#39;3_LE_vis&#39;: 23.44478306000893}}
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">vis_Rn</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">400</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;min&#39;][&#39;0_Rn&#39;],</span>
          <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span> <span class="c1">#img_final_stats[&#39;max&#39;][&#39;0_Rn&#39;],</span>
          <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">)}</span> <span class="c1"># 1. gist_rainbow_r, 2. YlGnBu</span>

<span class="n">vis_G</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>   <span class="c1"># img_final_stats[&#39;min&#39;][&#39;1_G&#39;],</span>
         <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;max&#39;][&#39;1_G&#39;],</span>
         <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">)}</span> <span class="c1"># 1. RdYlGn_r, 2. BrBG_r</span>

<span class="n">vis_H</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span>   <span class="c1"># img_final_stats[&#39;min&#39;][&#39;2_H&#39;],</span>
         <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">700</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;max&#39;][&#39;2_H&#39;],</span>
         <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlGn_r&#39;</span><span class="p">)}</span>

<span class="n">vis_LE</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;min&#39;][&#39;3_LE&#39;],</span>
          <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">300</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;max&#39;][&#39;3_LE&#39;],</span>
          <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">cmp</span><span class="o">.</span><span class="n">get_palette</span><span class="p">(</span><span class="s1">&#39;RdYlBu_r&#39;</span><span class="p">)}</span> <span class="c1"># RdYlBu_r</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Listas para iteraciones </span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;]</span>
<span class="n">lista_fechas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;13-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;29-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;10-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;05-May&#39;</span><span class="p">,</span> <span class="s1">&#39;21-May&#39;</span><span class="p">,</span> <span class="s1">&#39;14-Jun&#39;</span><span class="p">]</span>
<span class="n">lista_paletas</span> <span class="o">=</span> <span class="p">[</span><span class="n">vis_Rn</span><span class="p">,</span> <span class="n">vis_G</span><span class="p">,</span> <span class="n">vis_H</span><span class="p">,</span> <span class="n">vis_LE</span><span class="p">]</span>
<span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0_Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;1_G&#39;</span><span class="p">,</span> <span class="s1">&#39;2_H&#39;</span><span class="p">,</span> <span class="s1">&#39;3_LE_vis&#39;</span><span class="p">]</span>
<span class="n">lista_etiquetas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rn (W/m m$^{-2}$)&#39;</span><span class="p">,</span> <span class="s1">&#39;G (W m$^{-2}$)&#39;</span><span class="p">,</span> <span class="s1">&#39;H (W m$^{-2}$)&#39;</span><span class="p">,</span> <span class="s1">&#39;LE (W m$^{-2}$)&#39;</span><span class="p">]</span> 

<span class="n">save_filename</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># None para no guardar, True u otra cosa para guardar</span>

<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    
    <span class="c1"># Selección de imagenes Landsat: 0 1 Enero, 2 Marzo, 3 Junio</span>
    <span class="n">img_productos</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span> <span class="c1"># &lt;-- Cambiar por cada grafica</span>
    
    <span class="c1"># --------------------------------------------------------------------</span>
    <span class="c1"># Elaboración de gráfica</span>
    <span class="c1"># --------------------------------------------------------------------</span>
    
    <span class="n">extent</span> <span class="o">=</span> <span class="mf">0.0005</span>
    <span class="n">zoom_region</span> <span class="o">=</span> <span class="p">[</span>
        <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="n">extent</span>
    <span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

    <span class="c1"># Fecha ubicado a la izquierda</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.7872</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> 
    
    <span class="n">left</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="c1"># 0.875</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># 0.02</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mf">0.325</span> <span class="c1"># 0.125</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="mi">1000</span>    
    
    <span class="n">extent1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">extent</span>
    <span class="n">extent2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">extent</span>
    
    <span class="k">if</span> <span class="n">index</span> <span class="o">!=</span> <span class="p">(</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
            <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                              <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span> 
                              <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> 
                              <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> 
                              <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="c1"># lista_vispaletas conjunto de vis</span>
            <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        
        <span class="c1"># 1. Rn</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>                        
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 2. G</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.38</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 3. H</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.56</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span> <span class="c1"># &lt;-- Asignación de ticks para H</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 4. LE</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.74</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span> <span class="c1"># &lt;-- Asignación de ticks para LE</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="c1"># Guardar</span>
    <span class="k">if</span> <span class="n">save_filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">img_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Balance_Fecha-</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">.png&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="n">img_name</span><span class="p">),</span> 
                    <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span> <span class="c1">#, dpi=400);</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7b4bebe9dbe78b9236bcc20faccbcdbc59cb77639925f3231d10f1c72549660a.png" src="_images/7b4bebe9dbe78b9236bcc20faccbcdbc59cb77639925f3231d10f1c72549660a.png" />
<img alt="_images/e426391e536df7cc2daeec14c5da0f2087edd9871d77ea5e5e08421882c1fd2f.png" src="_images/e426391e536df7cc2daeec14c5da0f2087edd9871d77ea5e5e08421882c1fd2f.png" />
<img alt="_images/8dbc16d83bb76c5151928e50347b883e2964c84da3634e7c2204ec8e9843674d.png" src="_images/8dbc16d83bb76c5151928e50347b883e2964c84da3634e7c2204ec8e9843674d.png" />
<img alt="_images/bc2ddb921853445c6d169331b01deaf93d2b0c6722f75ded6d08360b8d3938a9.png" src="_images/bc2ddb921853445c6d169331b01deaf93d2b0c6722f75ded6d08360b8d3938a9.png" />
<img alt="_images/d3a4c377489e6b3af394b61b46db974a4d85acbeb6180bc9a9a52ee4bab21383.png" src="_images/d3a4c377489e6b3af394b61b46db974a4d85acbeb6180bc9a9a52ee4bab21383.png" />
<img alt="_images/7232dd7a1b918d9a752b282dae040ea604c20d769f4fc0366722106444b077c1.png" src="_images/7232dd7a1b918d9a752b282dae040ea604c20d769f4fc0366722106444b077c1.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Listas para iteraciones </span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;]</span>
<span class="n">lista_fechas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;13-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;29-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;10-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;05-May&#39;</span><span class="p">,</span> <span class="s1">&#39;21-May&#39;</span><span class="p">,</span> <span class="s1">&#39;14-Jun&#39;</span><span class="p">]</span>
<span class="n">lista_paletas</span> <span class="o">=</span> <span class="p">[</span><span class="n">vis_Rn</span><span class="p">,</span> <span class="n">vis_G</span><span class="p">,</span> <span class="n">vis_H</span><span class="p">,</span> <span class="n">vis_LE</span><span class="p">]</span>
<span class="n">lista_variables</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0_Rn&#39;</span><span class="p">,</span> <span class="s1">&#39;1_G&#39;</span><span class="p">,</span> <span class="s1">&#39;2_H&#39;</span><span class="p">,</span> <span class="s1">&#39;3_LE_vis&#39;</span><span class="p">]</span>
<span class="n">lista_etiquetas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Rn (W/m$^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="s1">&#39;G (W/m$^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="s1">&#39;H (W/m$^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">,</span> <span class="s1">&#39;LE (W/m$^</span><span class="si">{2}</span><span class="s1">$)&#39;</span><span class="p">]</span> 

<span class="n">save_filename</span> <span class="o">=</span> <span class="kc">True</span> <span class="c1"># None para no guardar, True u otra cosa para guardar</span>

<span class="c1"># for index in range(n_imgs):</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="p">[</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">]:</span>
    
    <span class="c1"># Selección de imagenes Landsat: 0 1 Enero, 2 Marzo, 3 Junio</span>
    <span class="n">img_productos</span> <span class="o">=</span> <span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_CompBalance&#39;</span><span class="p">]</span> <span class="c1"># &lt;-- Cambiar por cada grafica</span>
    
    <span class="c1"># --------------------------------------------------------------------</span>
    <span class="c1"># Elaboración de gráfica</span>
    <span class="c1"># --------------------------------------------------------------------</span>
    
    <span class="n">extent</span> <span class="o">=</span> <span class="mf">0.0005</span>
    <span class="n">zoom_region</span> <span class="o">=</span> <span class="p">[</span>
        <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="n">extent</span>
    <span class="p">]</span>

    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
    <span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">)</span>
    <span class="n">axs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

    <span class="c1"># Fecha ubicado a la izquierda</span>
    <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.7872</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">lista_fechas</span><span class="p">[</span><span class="n">index</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> 
    
    <span class="n">left</span> <span class="o">=</span> <span class="mf">0.45</span> <span class="c1"># 0.875</span>
    <span class="n">bottom</span> <span class="o">=</span> <span class="o">-</span><span class="mf">0.2</span>
    <span class="n">width</span> <span class="o">=</span> <span class="mf">0.02</span> <span class="c1"># 0.02</span>
    <span class="n">height</span> <span class="o">=</span> <span class="mf">0.325</span> <span class="c1"># 0.125</span>
    <span class="n">dims</span> <span class="o">=</span> <span class="mi">1000</span>    
    
    <span class="n">extent1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">+</span><span class="mi">9</span><span class="o">*</span><span class="n">extent</span>
    <span class="n">extent2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="mi">4</span><span class="o">*</span><span class="n">extent</span>
    
    <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="p">(</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        
        <span class="c1"># 1. Rn</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>                        
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 2. G</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.38</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">])</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 3. H</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">2</span><span class="p">]),</span>
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.56</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">500</span><span class="p">,</span> <span class="mi">700</span><span class="p">])</span> <span class="c1"># &lt;-- Asignación de ticks para H</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        
        <span class="c1"># 4. LE</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">img_productos</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="n">lista_variables</span><span class="p">[</span><span class="mi">3</span><span class="p">]),</span> 
                          <span class="n">dims</span><span class="o">=</span><span class="n">dims</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span> <span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">])</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">lista_paletas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="n">posOpts</span><span class="o">=</span><span class="p">[</span><span class="mf">0.74</span><span class="p">,</span> <span class="n">bottom</span><span class="p">,</span> <span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="p">],</span>
                             <span class="n">ticks</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">300</span><span class="p">])</span> <span class="c1"># &lt;-- Asignación de ticks para LE</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="n">lista_etiquetas</span><span class="p">[</span><span class="mi">3</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
        <span class="n">axs</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
    <span class="c1"># Guardar</span>
    <span class="k">if</span> <span class="n">save_filename</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">img_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Balance_Fecha-</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s1">.png&#39;</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="n">img_name</span><span class="p">),</span> 
                    <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span><span class="o">=</span><span class="mf">.1</span><span class="p">)</span> <span class="c1">#, dpi=400);</span>
    
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/2ec8bd53a0f880ce231469daa98709e47d3a28ef751013925c12c8509d5377c7.png" src="_images/2ec8bd53a0f880ce231469daa98709e47d3a28ef751013925c12c8509d5377c7.png" />
</div>
</div>
</section>
<section id="graficas-1x1">
<h4><span class="section-number">5.2.3.3. </span>Gráficas 1x1<a class="headerlink" href="#graficas-1x1" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Generar gráficas de variables determinadas</span>
<span class="c1"># [&#39;NDVI&#39;,  &#39;SAVI&#39;, &#39;LAI&#39;, &#39;albedo&#39;, &#39;Ts_k&#39;, &#39;Ts_c&#39;, &#39;t_sw&#39;, &#39;e_0&#39;, &#39;e_NB&#39;, &#39;cos_theta&#39;, &#39;cos_theta_1&#39;, &#39;slope&#39;, &#39;elevation&#39;]</span>
<span class="k">for</span> <span class="n">n_img</span><span class="p">,</span> <span class="n">img</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lista_imgprocesadas</span><span class="p">):</span>

    <span class="c1"># img_rgb_sr = img[&#39;img_SR&#39;]</span>
    <span class="n">img_</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s1">&#39;img_productos&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">select</span><span class="p">(</span><span class="s1">&#39;NDVI&#39;</span><span class="p">)</span>
    <span class="n">fecha</span> <span class="o">=</span> <span class="n">img</span><span class="p">[</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span>

    <span class="n">vis_params_ndvi</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
                       <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span>
                       <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="p">}</span>
    
    <span class="c1"># vis_params_sr = {&#39;bands&#39;: [&#39;SR_B4&#39;, &#39;SR_B3&#39;, &#39;SR_B2&#39;], &#39;min&#39;: 0.0, &#39;max&#39;: 0.3, &#39;gamma&#39;:1.3}</span>
    <span class="n">vis_params_alb</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span>
        <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mf">0.25</span><span class="p">,</span>
        <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">ndvi_cmap</span><span class="c1">#cmp.get_palette(&#39;gray&#39;) </span>
    <span class="p">}</span>
    
    <span class="n">title_map</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1"> - NDVI&#39;</span>
    
    <span class="n">get_grafica_cartoee_color</span><span class="p">(</span><span class="n">img_</span><span class="o">.</span><span class="n">clip</span><span class="p">(</span><span class="n">predios_agricolas</span><span class="p">)</span><span class="o">.</span><span class="n">blend</span><span class="p">(</span><span class="n">predios_vis</span><span class="p">),</span> 
                                  <span class="n">vis_params_ndvi</span><span class="p">,</span>                              
                                  <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                                  <span class="n">title_map</span><span class="o">=</span><span class="n">title_map</span><span class="p">,</span>
                                  <span class="n">label</span><span class="o">=</span><span class="s1">&#39;NDVI&#39;</span><span class="p">,</span> 
                                  <span class="n">save_fig</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_NDVI&#39;</span><span class="p">,</span>
                                  <span class="n">nogrid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="grafica-et">
<h4><span class="section-number">5.2.3.4. </span>Gráfica ET<a class="headerlink" href="#grafica-et" title="Link to this heading">#</a></h4>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preparamos una lista con imagenes de ET</span>
<span class="n">lista_et</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="n">lista_et</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;img_ETinst&#39;</span><span class="p">])</span> <span class="c1"># Banda &#39;ET&#39;</span>
    
<span class="n">pprint</span><span class="p">(</span><span class="n">lista_et</span><span class="p">)</span>

<span class="c1"># Convertimos la lista de imagenes en una sola con cada elemento como banda</span>
<span class="n">img_ET_final</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Image</span><span class="p">(</span><span class="n">lista_et</span><span class="p">)</span> 
<span class="n">img_ET_final</span><span class="o">.</span><span class="n">bandNames</span><span class="p">()</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span> <span class="c1"># Asigna el sufijo _# dependiendo del número de bandas comenzando desde el segundo con _1</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&lt;ee.image.Image object at 0x0000018B99977E80&gt;,
 &lt;ee.image.Image object at 0x0000018B9BADCDC0&gt;,
 &lt;ee.image.Image object at 0x0000018B9BB8E560&gt;,
 &lt;ee.image.Image object at 0x0000018B9BE166E0&gt;,
 &lt;ee.image.Image object at 0x0000018B9BE168F0&gt;,
 &lt;ee.image.Image object at 0x0000018B9BBC1F90&gt;]
</pre></div>
</div>
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ET&#39;, &#39;ET_1&#39;, &#39;ET_2&#39;, &#39;ET_3&#39;, &#39;ET_4&#39;, &#39;ET_5&#39;]
</pre></div>
</div>
</div>
</div>
<section id="grafica-et-1x7-muy-largo-y-no-se-ubica-bien-la-rampa-de-color">
<h5><span class="section-number">5.2.3.4.1. </span>Gráfica ET 1x7 (Muy largo y no se ubica bien la rampa de color)<a class="headerlink" href="#grafica-et-1x7-muy-largo-y-no-se-ubica-bien-la-rampa-de-color" title="Link to this heading">#</a></h5>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># --------------------------------------------------------------------</span>
<span class="c1"># Elaboración de gráfica de ET con 4 columnas y 1 fila</span>
<span class="c1"># Requisito: Tener las 4 imagenes de ET guardadas en una lista</span>
<span class="c1"># --------------------------------------------------------------------</span>
<span class="c1"># Parámetros previos</span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;14-Jun&#39;]</span>
<span class="n">lista_fechas</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;13-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;29-Ene&#39;</span><span class="p">,</span> <span class="s1">&#39;10-Mar&#39;</span><span class="p">,</span> <span class="s1">&#39;03-Abr&#39;</span><span class="p">,</span> <span class="s1">&#39;05-May&#39;</span><span class="p">,</span> <span class="s1">&#39;21-May&#39;</span><span class="p">,</span><span class="s1">&#39;14-Jun&#39;</span><span class="p">]</span>
<span class="c1"># lista_fechas = [&#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;, &#39;14-Jun&#39;] # &lt;------------</span>
<span class="n">imgs_ET</span> <span class="o">=</span> <span class="n">lista_et</span>

<span class="c1"># Parametros de visualización</span>
<span class="c1"># paleta_ET = cmp.get_palette(&#39;RdYlGn_r&#39;)</span>
<span class="c1"># paleta_ET.insert(0, &#39;FFFFFF&#39;)</span>
<span class="n">paleta_ET</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;F5F5D9&quot;</span><span class="p">,</span><span class="s2">&quot;D1B586&quot;</span><span class="p">,</span><span class="s2">&quot;8BFF00&quot;</span><span class="p">,</span><span class="s2">&quot;52E0CF&quot;</span><span class="p">,</span><span class="s2">&quot;136400&quot;</span><span class="p">,</span><span class="s2">&quot;0000FF&quot;</span><span class="p">]</span>
<span class="n">vis_ET</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;min&#39;][&#39;3_LE&#39;],</span>
          <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="c1"># img_final_stats[&#39;max&#39;][&#39;3_LE&#39;],</span>
          <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">paleta_ET</span><span class="p">}</span>

<span class="c1"># Gráfica</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">gs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_gridspec</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="n">n_imgs</span><span class="p">,</span> <span class="n">wspace</span><span class="o">=-</span><span class="mf">0.05</span><span class="p">)</span> 
<span class="n">axs</span> <span class="o">=</span> <span class="n">gs</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="n">ccrs</span><span class="o">.</span><span class="n">PlateCarree</span><span class="p">()})</span>

<span class="n">extent</span> <span class="o">=</span> <span class="mf">0.0005</span>

<span class="n">extent1</span> <span class="o">=</span> <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="mi">3</span><span class="o">*</span><span class="n">extent</span>
<span class="n">extent2</span> <span class="o">=</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">-</span><span class="n">extent</span>

<span class="n">zoom_region</span> <span class="o">=</span> <span class="p">[</span>
    <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span>
    <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="n">extent</span>
<span class="p">]</span>

<span class="n">posOpts</span> <span class="o">=</span> <span class="p">[</span>
    <span class="mf">0.875</span><span class="p">,</span> <span class="c1"># left</span>
    <span class="mf">0.30</span><span class="p">,</span>  <span class="c1"># bottom</span>
    <span class="mf">0.02</span><span class="p">,</span>  <span class="c1"># width</span>
    <span class="mf">0.35</span>   <span class="c1"># height</span>
<span class="p">]</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.7872</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">lista_fechas</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    <span class="n">cartoee</span><span class="o">.</span><span class="n">add_layer</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">imgs_ET</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">dims</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_ET</span><span class="p">)</span>
    <span class="n">axs</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    
<span class="n">ticks</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mi">12</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">axs</span><span class="p">[</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_ET</span><span class="p">,</span> <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> 
                     <span class="n">posOpts</span><span class="o">=</span><span class="n">posOpts</span><span class="p">,</span> <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">ticks</span><span class="o">=</span><span class="n">ticks</span><span class="p">,</span> <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">minorticks_on</span><span class="p">()</span>
<span class="n">axs</span><span class="p">[</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">extent1</span><span class="p">,</span> <span class="n">extent2</span><span class="p">,</span> <span class="s1">&#39;ETc</span><span class="se">\n</span><span class="s1">($mm\;d^{-1}$)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>

<span class="c1"># Guardar imagen</span>
<span class="c1"># img_name = &#39;output/ETinst.jpg&#39;</span>
<span class="c1"># plt.savefig(img_name, bbox_inches=&#39;tight&#39;, pad_inches=.1) #, dpi=400);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\USUARIO\anaconda3\envs\gee\lib\site-packages\geemap\cartoee.py:407: UserWarning: discrete keyword used when &quot;palette&quot; key is supplied with visParams, creating a continuous colorbar...
  warnings.warn(
</pre></div>
</div>
<img alt="_images/66e3c5226c25c56d6b4d873eb0e13d16d2040c8be2ebc1ca581fdad5b53d6d0c.png" src="_images/66e3c5226c25c56d6b4d873eb0e13d16d2040c8be2ebc1ca581fdad5b53d6d0c.png" />
</div>
</div>
</section>
<section id="id1">
<h5><span class="section-number">5.2.3.4.2. </span>Gráficas 1x1<a class="headerlink" href="#id1" title="Link to this heading">#</a></h5>
<p>Producir 6 imágenes como mosaico y agregar la última</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Función</span>
<span class="k">def</span> <span class="nf">get_grafica_cartoee_color</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> 
                              <span class="n">vis_params</span><span class="p">,</span>
                              <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>                             
                              <span class="n">text</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">title_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> 
                              <span class="n">save_fig</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">nogrid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">scale_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">    </span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Obtener gráficas con cartoee</span>
<span class="sd">    La variable zoom_region debe asignarse según la zona de estudio.</span>
<span class="sd">    Para modificaciones seguir: https://geemap.org/cartoee/#cartoee-module</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Establecer área de plot usando las coordenadas de predios_bound.coordinates().getInfo()</span>
    <span class="n">extent</span> <span class="o">=</span> <span class="mf">0.0005</span>
    <span class="n">zoom_region</span> <span class="o">=</span> <span class="p">[</span>
        <span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.605665317455976</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span>
        <span class="o">-</span><span class="mf">79.78719338866794</span><span class="o">-</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="n">extent</span>
    <span class="p">]</span>
    
    <span class="c1"># Establecer figsize para plot</span>
    <span class="k">if</span> <span class="n">figsize</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># fig = plt.figure(figsize=(5,5)) # Para juntar en forma de mosaicos</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">6</span><span class="p">))</span> <span class="c1"># Para analizar</span>
        <span class="c1"># fig = plt.figure(figsize=(16,12)) # Para recortar la barra</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="n">figsize</span><span class="p">)</span> <span class="c1"># Para analizar</span>
    
    <span class="c1"># ee.Image a plotear</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">cartoee</span><span class="o">.</span><span class="n">get_map</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">region</span><span class="o">=</span><span class="n">zoom_region</span><span class="p">,</span> <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_params</span><span class="p">)</span>

    <span class="c1"># Añadir grillas</span>
    <span class="k">if</span> <span class="n">nogrid</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_gridlines</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> 
                              <span class="n">interval</span><span class="o">=</span><span class="mf">0.005</span><span class="p">,</span> 
                              <span class="n">ytick_rotation</span><span class="o">=</span><span class="mi">90</span><span class="p">,</span> 
                              <span class="n">linestyle</span><span class="o">=</span><span class="s2">&quot;:&quot;</span><span class="p">,</span> 
                              <span class="n">linewidth</span><span class="o">=</span><span class="mi">0</span> <span class="c1"># Grillas invisibles</span>
                              <span class="p">)</span> <span class="c1"># xtick_rotation=45</span>

    <span class="c1"># Añadir barra de color</span>
    <span class="k">if</span> <span class="n">label</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_colorbar</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> 
                             <span class="n">vis_params</span><span class="o">=</span><span class="n">vis_params</span><span class="p">,</span> 
                             <span class="n">loc</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">,</span> 
                             <span class="c1"># label=label, </span>
                             <span class="c1">#posOpts=[0.86, 0.25, 0.02, 0.5],</span>
                             <span class="n">posOpts</span><span class="o">=</span> <span class="p">[</span>
                                 <span class="mf">0.9</span><span class="p">,</span> <span class="c1"># left</span>
                                 <span class="mf">0.25</span><span class="p">,</span>  <span class="c1"># bottom</span>
                                 <span class="mf">0.04</span><span class="p">,</span>  <span class="c1"># width</span>
                                 <span class="mf">0.5</span>   <span class="c1"># height</span>
                                 <span class="p">],</span>
                             <span class="n">tick_font_size</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span>
                             <span class="c1"># ticks= [0,2,4,6,8,10],</span>
                             <span class="c1"># drawedges=True, </span>
                             <span class="c1"># extend=&#39;both&#39;, # Genera flechas hacia los extremos</span>
                             <span class="n">discrete</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                             <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;proportional&#39;</span>
                             <span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.77332525015065</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
    
    <span class="c1"># Añadir texto</span>
    <span class="k">if</span> <span class="n">title_map</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="n">title_map</span><span class="p">)</span> <span class="c1"># , fontsize=11</span>
        
    <span class="k">if</span> <span class="n">text</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="o">-</span><span class="mf">79.7872</span><span class="p">,</span> <span class="o">-</span><span class="mf">6.594549</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">extent</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span> 
        <span class="c1"># fontsize=18 para mejor visibilidad en mosaicos</span>
        
    <span class="c1"># add scale bar</span>
    <span class="k">if</span> <span class="n">scale_bar</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">scale_bar_dict</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;length&quot;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span> 
            <span class="s2">&quot;xy&quot;</span><span class="p">:</span> <span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> 
            <span class="s2">&quot;linewidth&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span>
            <span class="s2">&quot;fontsize&quot;</span><span class="p">:</span> <span class="mi">12</span><span class="p">,</span>
            <span class="s2">&quot;color&quot;</span><span class="p">:</span> <span class="s2">&quot;black&quot;</span><span class="p">,</span>
            <span class="s2">&quot;unit&quot;</span><span class="p">:</span> <span class="s2">&quot;m&quot;</span><span class="p">,</span>
            <span class="s2">&quot;ha&quot;</span><span class="p">:</span> <span class="s2">&quot;center&quot;</span><span class="p">,</span>
            <span class="s2">&quot;va&quot;</span><span class="p">:</span> <span class="s2">&quot;bottom&quot;</span><span class="p">,</span>    
        <span class="p">}</span>
        <span class="n">cartoee</span><span class="o">.</span><span class="n">add_scale_bar_lite</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="o">**</span><span class="n">scale_bar_dict</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="n">axis</span> <span class="o">=</span> <span class="s1">&#39;both&#39;</span><span class="p">)</span> <span class="c1"># , labelsize = 9</span>
    
    <span class="c1"># Guardar graficas</span>
    <span class="k">if</span> <span class="n">save_fig</span> <span class="o">!=</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">save_fig</span> <span class="o">+</span> <span class="s1">&#39;.png&#39;</span><span class="p">,</span> <span class="n">bbox_inches</span> <span class="o">=</span> <span class="s1">&#39;tight&#39;</span><span class="p">,</span> <span class="n">pad_inches</span> <span class="o">=</span> <span class="mf">.1</span><span class="p">)</span><span class="c1">#, dpi=400)</span>
        <span class="c1"># Recortar márgenes con ayuda de bbox_inches y pad_inches</span>
        
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Parámetros de visualización</span>
<span class="c1"># lista_fechas = [&#39;13-Ene&#39;, &#39;29-Ene&#39;, &#39;10-Mar&#39;, &#39;03-Abr&#39;, &#39;05-May&#39;, &#39;21-May&#39;,&#39;14-Jun&#39;]</span>
<span class="n">imgs_ET</span> <span class="o">=</span> <span class="n">lista_et</span>

<span class="n">paleta_ET</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#F5F5D9&quot;</span><span class="p">,</span> <span class="s2">&quot;#D1B586&quot;</span><span class="p">,</span> <span class="s2">&quot;#8BFF00&quot;</span><span class="p">,</span> <span class="s2">&quot;#52E0CF&quot;</span><span class="p">,</span> <span class="s2">&quot;#136400&quot;</span><span class="p">,</span> <span class="s2">&quot;#0000FF&quot;</span><span class="p">]</span> <span class="c1"># &quot;F5F5D9&quot;,&quot;D1B586&quot;,&quot;8BFF00&quot;,&quot;52E0CF&quot;,&quot;136400&quot;,&quot;0000FF&quot;</span>
<span class="n">vis_ET</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">paleta_ET</span><span class="p">}</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
    <span class="n">nombre_img</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ET_</span><span class="si">{</span><span class="n">lista_imgprocesadas</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="s1">&#39;fecha&#39;</span><span class="p">]</span><span class="si">}</span><span class="s2">_3&quot;</span>
    <span class="n">get_grafica_cartoee_color</span><span class="p">(</span><span class="n">imgs_ET</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> 
                              <span class="n">vis_ET</span><span class="p">,</span>      
                              <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                              <span class="n">text</span><span class="o">=</span><span class="n">lista_fechas</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>  
                              <span class="n">save_fig</span><span class="o">=</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">carpeta_output</span><span class="p">,</span> <span class="n">nombre_img</span><span class="p">),</span>
                              <span class="n">nogrid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/675591d77c9a0cd7af4f5054fb9c27eea75a2fb99d8e11509fb17d3959dd51f2.png" src="_images/675591d77c9a0cd7af4f5054fb9c27eea75a2fb99d8e11509fb17d3959dd51f2.png" />
<img alt="_images/ba29d2456aca97a8eb2ce97768bdc1efaa02b86959e21b4c3d04071f836e42a7.png" src="_images/ba29d2456aca97a8eb2ce97768bdc1efaa02b86959e21b4c3d04071f836e42a7.png" />
<img alt="_images/a6bffb1ccda4c74a482a95e2886c949b7d68d67040c4ab34159b5237936e4844.png" src="_images/a6bffb1ccda4c74a482a95e2886c949b7d68d67040c4ab34159b5237936e4844.png" />
<img alt="_images/a998d09d040dc485af40823e587466579100716f6571059ccb18ee92c6d7c022.png" src="_images/a998d09d040dc485af40823e587466579100716f6571059ccb18ee92c6d7c022.png" />
<img alt="_images/a5de27e50fa24bc833b2de9455c32fa42e1cb5795ce9ac4ce039b2069b4572f3.png" src="_images/a5de27e50fa24bc833b2de9455c32fa42e1cb5795ce9ac4ce039b2069b4572f3.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># # Prueba Discretización</span>
<span class="c1"># img = imgs_ET[0]</span>

<span class="c1"># img_et_prueba = {</span>
<span class="c1">#     ee.Image(0)</span>
<span class="c1">#     .where(img.gte(0),1)</span>
<span class="c1">#     .where(img.gte(2),2)</span>
<span class="c1">#     .where(img.gte(4),3)</span>
<span class="c1">#     .where(img.gte(6),4)</span>
<span class="c1">#     .where(img.gte(8),5)</span>
<span class="c1">#     .where(img.gte(10),6).clip(predios_agricolas)</span>
<span class="c1"># }</span>

<span class="c1"># viz_clas = {&#39;palette&#39;: [&quot;#F5F5D9&quot;, &quot;#D1B586&quot;, &quot;#52E0CF&quot;, &quot;#8BFF00&quot;, &quot;#136400&quot;, &quot;#0000FF&quot;],</span>
<span class="c1">#             &#39;min&#39;: 1,</span>
<span class="c1">#             &#39;max&#39;: 6}</span>
<span class="c1"># # Mapas</span>
<span class="c1"># Map = geemap.Map()</span>
<span class="c1"># Map.centerObject(img_et_prueba, 16)</span>
<span class="c1"># Map.addLayer(img_et_prueba, viz_clas, &#39;img_et_prueba&#39;)</span>
<span class="c1"># Map</span>
</pre></div>
</div>
</div>
</div>
<p>Generar la última imagen con rampa de color para añadirlo al final</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">paleta_ET</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#F5F5D9&quot;</span><span class="p">,</span> <span class="s2">&quot;#F5F5D9&quot;</span><span class="p">,</span> <span class="s2">&quot;#D1B586&quot;</span><span class="p">,</span> <span class="s2">&quot;#D1B586&quot;</span><span class="p">,</span> <span class="s2">&quot;#8BFF00&quot;</span><span class="p">,</span> <span class="s2">&quot;#8BFF00&quot;</span><span class="p">,</span> <span class="s2">&quot;#52E0CF&quot;</span><span class="p">,</span> <span class="s2">&quot;#52E0CF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0000FF&quot;</span><span class="p">,</span> <span class="s2">&quot;#0000FF&quot;</span><span class="p">]</span> <span class="c1"># &quot;F5F5D9&quot;,&quot;D1B586&quot;,&quot;8BFF00&quot;,&quot;52E0CF&quot;,&quot;136400&quot;,&quot;0000FF&quot;</span>
<span class="n">vis_ET</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;min&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;max&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;palette&#39;</span><span class="p">:</span> <span class="n">paleta_ET</span><span class="p">}</span>

<span class="n">get_grafica_cartoee_color</span><span class="p">(</span><span class="n">imgs_ET</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> 
                          <span class="n">vis_ET</span><span class="p">,</span>      
                          <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">5</span><span class="p">),</span>
                          <span class="n">text</span><span class="o">=</span><span class="n">lista_fechas</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> 
                          <span class="n">title_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">label</span><span class="o">=</span> <span class="s1">&#39;ETc (mm/d)&#39;</span><span class="p">,</span> <span class="c1">#&#39;ETc ($mm\;d^{-1}$)&#39;, </span>
                          <span class="c1"># save_fig=os.path.join(carpeta_output, f&quot;ET_{lista_imgprocesadas[-1][&#39;fecha&#39;]}&quot;),</span>
                          <span class="n">nogrid</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                          <span class="n">scale_bar</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/6e71fe0459558a955303063c3eb0de8ed979a44509f8069e5ff8941991f599de.png" src="_images/6e71fe0459558a955303063c3eb0de8ed979a44509f8069e5ff8941991f599de.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Barra de color</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib</span> <span class="k">as</span> <span class="nn">mpl</span>
<span class="kn">from</span> <span class="nn">colour</span> <span class="kn">import</span> <span class="n">Color</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>

<span class="n">bounds</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">]</span>
<span class="n">paleta</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#F5F5D9&quot;</span><span class="p">,</span><span class="s2">&quot;#D1B586&quot;</span><span class="p">,</span><span class="s2">&quot;#8BFF00&quot;</span><span class="p">,</span><span class="s2">&quot;#52E0CF&quot;</span><span class="p">,</span><span class="s2">&quot;#136400&quot;</span><span class="p">,</span><span class="s2">&quot;#0000FF&quot;</span><span class="p">]</span> 
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="p">[</span> <span class="n">Color</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span><span class="o">.</span><span class="n">rgb</span> <span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">paleta</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">BoundaryNorm</span><span class="p">(</span><span class="n">bounds</span><span class="p">,</span> <span class="n">cmap</span><span class="o">.</span><span class="n">N</span><span class="p">)</span><span class="c1">#, extend=&#39;both&#39;)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">),</span>
             <span class="n">cax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;horizontal&#39;</span><span class="p">,</span>
             <span class="n">spacing</span><span class="o">=</span><span class="s1">&#39;proportional&#39;</span><span class="p">,</span>
             <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ETc (mm/d)&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/7c02b776c2748aa560fab051ac20afc835ddb2fb8c127d34a521b5c2e9b2449e.png" src="_images/7c02b776c2748aa560fab051ac20afc835ddb2fb8c127d34a521b5c2e9b2449e.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">),</span> <span class="n">layout</span><span class="o">=</span><span class="s1">&#39;constrained&#39;</span><span class="p">)</span>

<span class="n">paleta</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;#F5F5D9&quot;</span><span class="p">,</span><span class="s2">&quot;#D1B586&quot;</span><span class="p">,</span><span class="s2">&quot;#8BFF00&quot;</span><span class="p">,</span><span class="s2">&quot;#52E0CF&quot;</span><span class="p">,</span><span class="s2">&quot;#136400&quot;</span><span class="p">,</span><span class="s2">&quot;#0000FF&quot;</span><span class="p">]</span> 
<span class="n">cmap_lai2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;#ffffff&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;#ce7e45&#39;</span><span class="p">,</span> <span class="s1">&#39;#df923d&#39;</span><span class="p">,</span> <span class="s1">&#39;#f1b555&#39;</span><span class="p">,</span> <span class="s1">&#39;#fcd163&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;#99b718&#39;</span><span class="p">,</span> <span class="s1">&#39;#74a901&#39;</span><span class="p">,</span> <span class="s1">&#39;#66a000&#39;</span><span class="p">,</span> <span class="s1">&#39;#529400&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;#3e8601&#39;</span><span class="p">,</span> <span class="s1">&#39;#207401&#39;</span><span class="p">,</span> <span class="s1">&#39;#056201&#39;</span><span class="p">,</span> <span class="s1">&#39;#004c00&#39;</span><span class="p">,</span> 
             <span class="s1">&#39;#023b01&#39;</span><span class="p">,</span> <span class="s1">&#39;#012e01&#39;</span><span class="p">,</span> <span class="s1">&#39;#011d01&#39;</span><span class="p">,</span> <span class="s1">&#39;#011301&#39;</span><span class="p">]</span>
<span class="n">cmap</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">LinearSegmentedColormap</span><span class="o">.</span><span class="n">from_list</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span>  <span class="p">[</span> <span class="n">Color</span><span class="p">(</span><span class="n">c1</span><span class="p">)</span><span class="o">.</span><span class="n">rgb</span> <span class="k">for</span> <span class="n">c1</span> <span class="ow">in</span> <span class="n">cmap_lai2</span><span class="p">])</span>
<span class="n">norm</span> <span class="o">=</span> <span class="n">mpl</span><span class="o">.</span><span class="n">colors</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">mpl</span><span class="o">.</span><span class="n">cm</span><span class="o">.</span><span class="n">ScalarMappable</span><span class="p">(</span><span class="n">norm</span><span class="o">=</span><span class="n">norm</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">),</span>
             <span class="n">cax</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s1">&#39;vertical&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;ETc (mm/d)&quot;</span><span class="p">)</span>
<span class="c1"># fig.savefig(&#39;scalebar_dpi500.png&#39;, dpi=500)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.colorbar.Colorbar at 0x1bf83e514e0&gt;
</pre></div>
</div>
<img alt="_images/0fc91ffd20afdbb40ef5344c1c16aa3003fe798c5b5dc508357bdb7d7d29e2d4.png" src="_images/0fc91ffd20afdbb40ef5344c1c16aa3003fe798c5b5dc508357bdb7d7d29e2d4.png" />
</div>
</div>
</section>
</section>
</section>
<section id="grafica-boxplot">
<h3><span class="section-number">5.2.4. </span>Gráfica Boxplot<a class="headerlink" href="#grafica-boxplot" title="Link to this heading">#</a></h3>
<ol class="arabic simple">
<li><p>Import de archivo <code class="docutils literal notranslate"><span class="pre">.shp</span></code> de variedades</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Imports</span>
<span class="n">path_parcelas</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;input/Parcelas_wgs84_clip.shp&#39;</span>
<span class="n">fcol_parcelas</span> <span class="o">=</span> <span class="n">geemap</span><span class="o">.</span><span class="n">shp_to_ee</span><span class="p">(</span><span class="n">path_parcelas</span><span class="p">)</span>

<span class="c1"># 5 Variedades de arroz</span>
<span class="n">fcol_parcelas_var1</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;VARIEDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;CAPOTEÑA&#39;</span><span class="p">)</span>
<span class="n">fcol_parcelas_var2</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;VARIEDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;GALAN&#39;</span><span class="p">)</span>
<span class="n">fcol_parcelas_var3</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;VARIEDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;PAKAMURO&#39;</span><span class="p">)</span>
<span class="n">fcol_parcelas_var4</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;VARIEDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;PUNTILLA&#39;</span><span class="p">)</span>
<span class="n">fcol_parcelas_var5</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;VARIEDAD&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;VALOR&#39;</span><span class="p">)</span>

<span class="c1"># 2 Tipos de siembra</span>
<span class="n">fcol_parcelas_met1</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;Metodo_de_&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;TRANSPLANTE&#39;</span><span class="p">)</span>
<span class="n">fcol_parcelas_met2</span> <span class="o">=</span> <span class="n">fcol_parcelas</span><span class="o">.</span><span class="n">filterMetadata</span><span class="p">(</span><span class="s1">&#39;Metodo_de_&#39;</span><span class="p">,</span> <span class="s1">&#39;equals&#39;</span><span class="p">,</span> <span class="s1">&#39;SIEMBRA DIRECTA&#39;</span><span class="p">)</span>

<span class="c1"># Listas con nombres</span>
<span class="n">variedades_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Capoteña&#39;</span><span class="p">,</span> <span class="s1">&#39;Galan&#39;</span><span class="p">,</span> <span class="s1">&#39;Pakamuro&#39;</span><span class="p">,</span> <span class="s1">&#39;Puntilla&#39;</span><span class="p">,</span> <span class="s1">&#39;Valor&#39;</span><span class="p">]</span>
<span class="n">list_met_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Transplante&#39;</span><span class="p">,</span> <span class="s1">&#39;Siembra Directa&#39;</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Procesado para boxplot</p></li>
</ol>
<p>Inputs:</p>
<ul class="simple">
<li><p>Imagen de ET por fecha y con valores positivos</p></li>
<li><p>Shapefiles de áreas a analizar</p></li>
</ul>
<p>Procesamiento:</p>
<ul class="simple">
<li><p>Extraer valores de pixeles dentro de las áreas a analizar:</p>
<ul>
<li><p>Tipos de cultivos (5 tipos)</p></li>
<li><p>Tipos de siembra (2 tipos)</p></li>
</ul>
</li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Preparamos una lista con imagenes de ET</span>
<span class="n">lista_et</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n_imgs</span><span class="p">):</span>
    <span class="n">lista_et</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">lista_imgprocesadas_ET</span><span class="p">[</span><span class="n">index</span><span class="p">][</span><span class="s1">&#39;img_ETinst&#39;</span><span class="p">])</span> <span class="c1"># Banda &#39;ET&#39;</span>
    
<span class="n">pprint</span><span class="p">(</span><span class="n">lista_et</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&#39;ET&#39;, &#39;ET_1&#39;, &#39;ET_2&#39;, &#39;ET_3&#39;, &#39;ET_4&#39;, &#39;ET_5&#39;]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Armamos una lista con todos los valores de ET extraidos por cada shapefile</span>
<span class="n">lista_ET_valores_boxplot</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">img_ET</span> <span class="ow">in</span> <span class="n">lista_et</span><span class="p">:</span>
    
    <span class="n">img_ET_pos</span> <span class="o">=</span> <span class="n">img_ET</span><span class="o">.</span><span class="n">updateMask</span><span class="p">(</span><span class="n">img_ET</span><span class="o">.</span><span class="n">gte</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span><span class="c1">#.blend(predios_vis) # &lt;--- Valores positivos de ET</span>
    <span class="c1"># img_ET_neg = img_ET_inst.updateMask(img_ET_inst.lt(0))#.blend(predios_vis)</span>
    
    <span class="c1"># 5 Tipos de cultivos</span>
    <span class="n">list_et_val1</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_var1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;CAPOTEÑA&#39;</span>
    <span class="n">list_et_val2</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_var2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;GALAN&#39;</span>
    <span class="n">list_et_val3</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_var3</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;PAKAMURO&#39;</span>
    <span class="n">list_et_val4</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_var4</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;PUNTILLA&#39;</span>
    <span class="n">list_et_val5</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_var5</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;VALOR&#39;</span>
    
    <span class="n">list_values</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="n">list_et_val1</span><span class="p">,</span> <span class="n">list_et_val2</span><span class="p">,</span> <span class="n">list_et_val3</span><span class="p">,</span> <span class="n">list_et_val4</span><span class="p">,</span> <span class="n">list_et_val5</span><span class="p">])</span>
    
    <span class="c1"># 2 Tipos de siembra</span>
    <span class="n">list_et_met1</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_met1</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;TRANSPLANTE&#39;</span>
    <span class="n">list_et_met2</span> <span class="o">=</span> <span class="n">img_ET_pos</span><span class="o">.</span><span class="n">reduceRegion</span><span class="p">(</span><span class="n">ee</span><span class="o">.</span><span class="n">Reducer</span><span class="o">.</span><span class="n">toList</span><span class="p">(),</span> <span class="n">fcol_parcelas_met2</span><span class="p">,</span> <span class="mi">30</span><span class="p">)</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ET&#39;</span><span class="p">)</span> <span class="c1"># &#39;SIEMBRA DIRECTA</span>
    
    <span class="n">list_met</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">List</span><span class="p">([</span><span class="n">list_et_met1</span><span class="p">,</span> <span class="n">list_et_met2</span><span class="p">])</span>
    
    <span class="n">dict_boxplot</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;list_values&#39;</span><span class="p">:</span> <span class="n">list_values</span><span class="p">,</span>
        <span class="s1">&#39;list_met&#39;</span><span class="p">:</span> <span class="n">list_met</span>
    <span class="p">}</span>
    
    <span class="n">valores_boxplot</span> <span class="o">=</span> <span class="n">ee</span><span class="o">.</span><span class="n">Dictionary</span><span class="p">(</span><span class="n">dict_boxplot</span><span class="p">)</span>
    <span class="n">lista_ET_valores_boxplot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">valores_boxplot</span><span class="p">)</span>
    
<span class="c1"># Accedemos con .get</span>
<span class="c1"># valores_boxplot.get(&#39;list_values&#39;).getInfo()</span>
<span class="c1"># valores_boxplot.get(&#39;list_met&#39;).getInfo()</span>
</pre></div>
</div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Boxplot con seaborn</p></li>
</ol>
<p>El boxplot se armará mediante un DataFrame con los datos de los pixeles (uno muy grande por cierto).</p>
<p>Referencia: <a class="reference external" href="https://seaborn.pydata.org/generated/seaborn.boxplot.html">Seaborn - boxplot</a></p>
<p>Procesamiento:</p>
<ul class="simple">
<li><p>Armar el DataFrame por tipo con <code class="docutils literal notranslate"><span class="pre">pd.concat</span></code></p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="k">def</span> <span class="nf">prepare_df_vertical</span><span class="p">(</span><span class="n">lista_escogida</span><span class="p">,</span> <span class="n">lista_title</span><span class="p">,</span> <span class="n">column_name</span><span class="p">):</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">lista_escogida</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Valores&#39;</span><span class="p">])</span>
    <span class="n">df</span><span class="p">[</span><span class="n">column_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">lista_title</span>
    <span class="k">return</span> <span class="n">df</span>
</pre></div>
</div>
</div>
</div>
<p>Exportar datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">list_dates</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;2022-01-13&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-01-29&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-03-10&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-05-05&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-05-21&#39;</span><span class="p">,</span> <span class="s1">&#39;2022-06-14&#39;</span><span class="p">]</span>

<span class="c1"># Armar los dataframe por fecha</span>
<span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">fecha</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">list_dates</span><span class="p">):</span>

    <span class="n">ee_list_values</span> <span class="o">=</span> <span class="n">lista_ET_valores_boxplot</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;list_values&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
    <span class="n">ee_list_met</span> <span class="o">=</span> <span class="n">lista_ET_valores_boxplot</span><span class="p">[</span><span class="n">index</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;list_met&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">getInfo</span><span class="p">()</span>
    
    <span class="c1"># fecha proviene de correr la celda de radiación neta</span>
    <span class="n">df_var</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span><span class="n">prepare_df_vertical</span><span class="p">(</span><span class="n">ee_list_values</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">variedades_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;Variedad&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">)]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="n">df_met</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span>
        <span class="p">[</span><span class="n">prepare_df_vertical</span><span class="p">(</span><span class="n">ee_list_met</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">list_met_names</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="s1">&#39;Metodo&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">2</span><span class="p">)]</span>
        <span class="p">)</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    
    <span class="n">df_var</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fecha</span>
    <span class="n">df_met</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">fecha</span>
    
    <span class="n">df_var</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_var_boxplot.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">df_met</span><span class="o">.</span><span class="n">to_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_met_boxplot.csv&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8-sig&#39;</span><span class="p">,</span> <span class="n">index</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_var_boxplot.csv Listo!&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_met_boxplot.csv Listo!&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Importar datos</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importar cada dataframe de las fechas y concatenarlas en uno solo</span>
<span class="n">df_var</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_var_boxplot.csv&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">fecha</span> <span class="ow">in</span> <span class="n">list_dates</span>
<span class="p">])</span>
    
<span class="n">df_met</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span>
    <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;output/</span><span class="si">{</span><span class="n">fecha</span><span class="si">}</span><span class="s1">_df_met_boxplot.csv&#39;</span><span class="p">)</span> <span class="k">for</span> <span class="n">fecha</span> <span class="ow">in</span> <span class="n">list_dates</span>
<span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba de valores únicos</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_var</span><span class="o">.</span><span class="n">Variedad</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">df_met</span><span class="o">.</span><span class="n">Metodo</span><span class="o">.</span><span class="n">value_counts</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Variedad
Pakamuro    3029
Valor       1459
Galan       1078
Puntilla     375
Capoteña     173
Name: count, dtype: int64
Metodo
Siembra Directa    3122
Transplante        2992
Name: count, dtype: int64
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba</span>
<span class="n">df_met_mod</span> <span class="o">=</span> <span class="n">df_met</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_met_mod</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
<span class="n">df_met_mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores</th>
      <th>Metodo</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2.965952</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2.850396</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>2</th>
      <td>4.168058</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.787178</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4.180753</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>929</th>
      <td>2.639592</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>930</th>
      <td>1.931328</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>931</th>
      <td>1.010018</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>932</th>
      <td>2.420385</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>933</th>
      <td>1.982460</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
<p>6114 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original</span>
<span class="n">df_met_mod</span> <span class="o">=</span> <span class="n">df_met</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_met_mod</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
<span class="n">df_met_mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores</th>
      <th>Metodo</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.311557</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1.070096</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.706649</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1.057413</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>0.677171</td>
      <td>Transplante</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>3.775905</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>456</th>
      <td>2.517774</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>457</th>
      <td>1.191346</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>458</th>
      <td>3.092585</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>459</th>
      <td>2.127264</td>
      <td>Siembra Directa</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
<p>3227 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Prueba</span>
<span class="n">df_var_mod</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_var_mod</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
<span class="n">df_var_mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores</th>
      <th>Variedad</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.257524</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.198174</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3.102134</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>3.445272</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.123060</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>929</th>
      <td>2.289865</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>930</th>
      <td>2.496658</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>931</th>
      <td>2.403028</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>932</th>
      <td>2.286535</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>933</th>
      <td>2.845913</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
<p>6114 rows × 3 columns</p>
</div></div></div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Original</span>
<span class="n">df_var_mod</span> <span class="o">=</span> <span class="n">df_var</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">df_var_mod</span><span class="p">[</span><span class="s1">&#39;Fecha&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Total&#39;</span>
<span class="n">df_var_mod</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Valores</th>
      <th>Variedad</th>
      <th>Fecha</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.546960</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.907040</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1.851302</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.640290</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1.377977</td>
      <td>Capoteña</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>455</th>
      <td>1.662889</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>456</th>
      <td>1.265896</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>457</th>
      <td>1.534039</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>458</th>
      <td>1.696364</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
    <tr>
      <th>459</th>
      <td>1.512514</td>
      <td>Valor</td>
      <td>Total</td>
    </tr>
  </tbody>
</table>
<p>3227 rows × 3 columns</p>
</div></div></div>
</div>
<p>Por modificar:</p>
<ul class="simple">
<li><p>Aumentar tipo de fuente de los xlabel</p></li>
<li><p>Cambiar xlabel por el formato a usarse del articulo “12-Ene”</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;xtick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
<span class="n">plt</span><span class="o">.</span><span class="n">rcParams</span><span class="p">[</span><span class="s1">&#39;ytick.labelsize&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">14</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">fontsize_legend</span> <span class="o">=</span> <span class="mi">14</span>

<span class="c1"># Diagrama de cajas con todas las fechas procesadas</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">layout</span><span class="o">=</span><span class="s2">&quot;constrained&quot;</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>
<span class="n">subfigs</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">subfigures</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">width_ratios</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mf">1.</span><span class="p">])</span>

<span class="c1"># fig.suptitle(&#39;Diagrama de cajas - Evapotranspiración&#39;, fontsize=14)</span>

<span class="c1"># Sección izquierda ====================================</span>
<span class="c1"># Superior</span>
<span class="n">axs0</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">subfigs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">supylabel</span><span class="p">(</span><span class="s1">&#39;ET (mm/d)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fecha&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valores&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Variedad&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_var</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">showcaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#palette=[&#39;green&#39;,&#39;yellow&#39;,&#39;#f53232&#39;, &#39;#FFFFFF&#39;, &#39;#00B0FF&#39;], </span>
            <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">})</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">)</span>
<span class="c1"># axs0[0].tick_params(axis=&#39;y&#39;, labelsize=14)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>

<span class="c1"># Inferior</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fecha&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valores&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Metodo&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_met</span><span class="p">,</span> 
            <span class="n">ax</span><span class="o">=</span><span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">showcaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#palette=[&#39;green&#39;,&#39;yellow&#39;,&#39;#f53232&#39;, &#39;#FFFFFF&#39;, &#39;#00B0FF&#39;], </span>
            <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
            <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">})</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize_legend</span><span class="p">)</span>
<span class="c1"># axs0[1].tick_params(axis=&#39;y&#39;, labelsize=14)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">lista_fechas</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs0</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>


<span class="c1"># Sección derecha ====================================</span>
<span class="c1"># Superior</span>
<span class="n">axs1</span> <span class="o">=</span> <span class="n">subfigs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fecha&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valores&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Variedad&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_var_mod</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span>
            <span class="n">showcaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#palette=[&#39;green&#39;,&#39;yellow&#39;,&#39;#f53232&#39;, &#39;#FFFFFF&#39;, &#39;#00B0FF&#39;], </span>
            <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">})</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="c1"># axs1[0].tick_params(axis=&#39;y&#39;, labelsize=14)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">)</span>

<span class="c1"># Inferior</span>
<span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s2">&quot;Fecha&quot;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s2">&quot;Valores&quot;</span><span class="p">,</span> <span class="n">hue</span><span class="o">=</span><span class="s1">&#39;Metodo&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">df_met_mod</span><span class="p">,</span>
            <span class="n">ax</span><span class="o">=</span><span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
            <span class="n">showcaps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="c1">#palette=[&#39;green&#39;,&#39;yellow&#39;,&#39;#f53232&#39;, &#39;#FFFFFF&#39;, &#39;#00B0FF&#39;], </span>
            <span class="n">fliersize</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> 
            <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
            <span class="n">width</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
            <span class="n">medianprops</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;color&#39;</span><span class="p">:</span><span class="s1">&#39;white&#39;</span><span class="p">})</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_ticks_position</span><span class="p">(</span><span class="s2">&quot;right&quot;</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">get_legend</span><span class="p">()</span><span class="o">.</span><span class="n">remove</span><span class="p">()</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">top</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">([</span><span class="s1">&#39;Total&#39;</span><span class="p">],</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">16</span><span class="p">)</span>
<span class="c1"># axs1[1].tick_params(axis=&#39;y&#39;, labelsize=14)</span>
<span class="n">axs1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">alpha</span><span class="o">=</span><span class="mf">.2</span><span class="p">);</span>

<span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="s1">&#39;output/ETinst_Boxplot.png&#39;</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\USUARIO\AppData\Local\Temp\ipykernel_17992\897768794.py:39: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  axs0[1].set_xticklabels(lista_fechas, fontsize=16)
C:\Users\USUARIO\AppData\Local\Temp\ipykernel_17992\897768794.py:75: UserWarning: set_ticklabels() should only be used with a fixed number of ticks, i.e. after set_ticks() or using a FixedLocator.
  axs1[1].set_xticklabels([&#39;Total&#39;], fontsize=16)
</pre></div>
</div>
<img alt="_images/5ea743e4def3a199325d00b50413b9721d521ba55c7f025db7cd5d3d3b9e761b.png" src="_images/5ea743e4def3a199325d00b50413b9721d521ba55c7f025db7cd5d3d3b9e761b.png" />
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="4_Seleccion_pixeles.html"
       title="página anterior">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">anterior</p>
        <p class="prev-next-title"><span class="section-number">4. </span>Selección de pixeles</p>
      </div>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#inicio">5.1. Inicio</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#procesamiento">5.2. Procesamiento</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#tablas">5.2.1. Tablas</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#revisar-imagenes">5.2.2. Revisar imagenes</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#lai">5.2.2.1. LAI</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-con-cartoee">5.2.3. Gráficas con cartoee</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-ndvi-iaf-albedo-ts">5.2.3.1. Gráfica NDVI-IAF-Albedo-Ts</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-componentes-balance-radiacion">5.2.3.2. Gráfica Componentes Balance Radiación</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#graficas-1x1">5.2.3.3. Gráficas 1x1</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-et">5.2.3.4. Gráfica ET</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-et-1x7-muy-largo-y-no-se-ubica-bien-la-rampa-de-color">5.2.3.4.1. Gráfica ET 1x7 (Muy largo y no se ubica bien la rampa de color)</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">5.2.3.4.2. Gráficas 1x1</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#grafica-boxplot">5.2.4. Gráfica Boxplot</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Cesar Vilca - 2024
</p>

  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
    <a href="https://github.com/vilcagamarracf">github.com/vilcagamarracf</a>
</p>

</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>